<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:exsl="http://exslt.org/common" xmlns:ng="http://docbook.org/docbook-ng" xmlns:fb="http://ogp.me/ns/fb#">
<head>
<link href="https://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet"/>
<title>Образы - Руководство по эксплуатации OpenStack</title>
<meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"/>
<meta name="mavenGroupId" content="org.openstack.docs"/>
<meta name="mavenArtifactId" content="openstack-ops-manual"/>
<meta name="mavenVersionId" content="1.0.0"/>
<link rel="home" href="index.html" title="Руководство по эксплуатации OpenStack"/>
<link rel="up" href="user_facing_operations.html" title="Глава 10. Операции стороны пользователя"/>
<link rel="prev" href="user_facing_operations.html" title="Глава 10. Операции стороны пользователя"/>
<link rel="next" href="flavors.html" title="Flavors"/>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="git-sha" content="13fb30b7c263d715eee84f0ca1a16df79697eb88"/>
<meta name="buildTime" content="2014-12-12T17:43:03+00:00"/>
<script type="text/javascript">
            //The id for tree cookie
            var treeCookieId = "treeview-openstack-operations-guide";
            var language = "en";
            var w = new Object();
            //Localization
            txt_filesfound = 'Results';
            txt_enter_at_least_1_char = "You must enter at least one character.";
            txt_browser_not_supported = "Please enable JavaScript.";
            txt_please_wait = "Please wait. Search in progress...";
            txt_results_for = "Results for: ";
        </script><style type="text/css">
            input {
            margin-bottom: 5px;
            margin-top: 2px;
            }

            .folder {
            display: block;
            height: 22px;
            padding-left: 20px;
            background: transparent url(../common/jquery/treeview/images/folder.gif) 0 0px no-repeat;
            }
            
        </style>
<link rel="shortcut icon" href="../favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" type="text/css" href="../common/css/positioning.css"/>
<link rel="stylesheet" type="text/css" href="../common/css/custom.css"/>
<link rel="canonical" href="http://docs.openstack.org/openstack-ops/content//user_facing_images.html"/>
<!--[if IE]>
	<link rel="stylesheet" type="text/css" href="../common/css/ie.css"/>
	<![endif]-->
<link rel="stylesheet" type="text/css" href="../common/jquery/theme-redmond/jquery-ui-1.8.2.custom.css"/>
<link rel="stylesheet" type="text/css" href="../common/jquery/treeview/jquery.treeview.css"/>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.11.0.min.js"><!----></script>
<script type="text/javascript" src="../common/jquery/jquery-ui-1.8.2.custom.min.js"><!----></script>
<script type="text/javascript" src="../common/jquery/jquery.cookie.js"><!----></script>
<script type="text/javascript" src="../common/jquery/treeview/jquery.treeview.min.js"><!----></script>
<link rel="stylesheet" type="text/css" href="http://cdn.jsdelivr.net/qtip2/2.2.0/jquery.qtip.min.css"/>
<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/qtip2/2.2.0/jquery.qtip.min.js">
<!--jQuery plugin for glossary popups. --></script>
<script type="text/javascript" src="search/htmlFileList.js"><!----></script>
<script type="text/javascript" src="search/htmlFileInfoList.js"><!----></script>
<script type="text/javascript" src="search/nwSearchFnt.js"><!----></script>
<script type="text/javascript" src="search/stemmers/en_stemmer.js">
<!--//make this scalable to other languages as well.--></script>
<script type="text/javascript" src="search/index-1.js"><!----></script>
<script type="text/javascript" src="search/index-2.js"><!----></script>
<script type="text/javascript" src="search/index-3.js"><!----></script>
<script type="text/javascript">
	    var _gaq = _gaq || [];
	    _gaq.push(['_setAccount', 'UA-17511903-1']);
	    
	    _gaq.push(['_setDomainName', '.openstack.org']);	        
	        </script>
<script type="text/javascript" src="../common/ga.js"><!----></script>
<script language="javascript" src="/js/common.js"></script>
<script src="../common/highlight.pack.js"></script>
</head>
<body>
<!----><script type="text/javascript"><!--
hljs.initHighlightingOnLoad();
HeaderName = 'Образы';
PrevRef = 'user_facing_operations.html';
UpRef = 'user_facing_operations.html';
NextRef = 'flavors.html';//-->
</script>
<!----><script type="text/javascript" src="HeaderAndToolbar.js">
</script><script type="text/javascript"><!--
document.write(HeaderAndToolbar); //-->
</script>
<div id="content"><div class="section">
<div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both">
 <a id="user_facing_images"> </a>Образы</h2>
</div></div></div><div class="toc"><dl><dt><span class="section">
<a href="user_facing_images.html#add_images">Добавление образов</a></span></dt><dt><span class="section">
<a href="user_facing_images.html#sharing_images">Совместное использование образов проектами</a></span></dt><dt><span class="section">
<a href="user_facing_images.html#delete_images">Удаление образов</a></span></dt><dt><span class="section">
<a href="user_facing_images.html#other_cli">Другие параметры CLI</a></span></dt><dt><span class="section">
<a href="user_facing_images.html#image_service_and_database">Служба образов и базы данных</a></span></dt><dt><span class="section">
<a href="user_facing_images.html#sample_image_database">Пример запросов к базе данных службы образов</a></span></dt></dl>
</div>
<p>Образы OpenStack часто могут рассматриваться как &quot;шаблоны виртуальных 
машин&quot;. Они также могут быть стандартными носителями для установки, 
такими как образы ISO. По существу, они содержат загружаемые файловые системы, которые используются 
для запуска экземпляров.
<a id="d9e3949" class="indexterm"/></p>
<div class="section">
<div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">
 <a id="add_images"> </a>Добавление образов</h3>
</div></div></div>
<p>Существуют некоторые предварительно собранные образы и они могут быть легко импортированы в 
службу образов (Image service). Образ CirrOS является очень маленьким общеупотребимым образом 
для добавления и используется для целей тестирования.
<a id="d9e3955" class="indexterm"/> Чтобы добавить этот образ, просто выполните:</p>
<pre class="screen">$ wget http://download.cirros-cloud.net/0.3.1/cirros-0.3.1-x86_64-disk.img
$ glance image-create --name='cirros image' --is-public=true \
  --container-format=bare --disk-format=qcow2 &lt; cirros-0.3.1-x86_64-disk.img</pre>
<p>Команда <code class="code">glance image-create</code> предоставляет большой набор 
параметров для обеспечения вас образами. Например, параметр 
<code class="code">min-disk</code> полезен для образов, которые требуют root 
диски определенного размера (например, большие образы Windows). Для ознакомления 
с этими параметрами выполните:</p>
<pre class="screen">$ glance help image-create</pre>
<p>Важно отметить параметр расположения (<code class="code">location</code>). Он не копирует 
весь образ в Glance, а вместо этого дает ссылку на оригинальное местоположение, 
по которой может быть найден данный образ. 
После запуска экземпляра данного образа служба образов получает 
образ из описанного местоположения.</p>
<p>Параметр <code class="code">copy-from</code> копирует образ из описанного 
местоположения в каталог <code class="code">/var/lib/glance/images</code>. 
То же самое выполняется при перенаправлении STDIN при помощи &lt;, 
как это демонстрируется в примере. 
The <code class="code">copy-from</code> option copies the image from the
location specified into the <code class="code">/var/lib/glance/images</code>
directory. The same thing is done when using the STDIN redirection with
&lt;, as shown in the example.</p>
<p>Выполните следующую команду, чтобы посмотреть свойства существующих образов:</p>
<pre class="screen">$ glance details</pre>
</div>
<div class="section">
<div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">
 <a id="sharing_images"> </a>Совместное использование образов проектами</h3>
</div></div></div>
<p>В облачных средах с многими владельцами пользователи иногда хотят  
использовать свои персональные образы или моментальные снимки совместно с другими
проектами.
<a id="d9e3973" class="indexterm"/>
<a id="d9e3976" class="indexterm"/> 
Это может быть выполнено из командной строки посредством инструментария 
<code class="literal">glance</code> владельцем образа.</p>
<p>Для начала совместного с другим проектом использования образа или 
моментального снимка выполните следующее:</p>
<div class="procedure"><ol class="procedure" type="1"><li class="step">
<p>Получите UUID образа:</p>
<pre class="screen">$ glance image-list</pre></li><li class="step">
<p>Получите UUID с которым вы хотите совместно использовать свой образ.
К сожалению, пользователи без прав администратора не могут использовать
команду <code class="literal">keystone</code> чтобы выполнить это.
Простейшим решением будет получение UUID либо у администратора облака,
либо от расположенного в этом проекте пользователя.</p></li><li class="step">
<p>Получив значения обоих элементов, выполните команду
<code class="literal">glance</code>:</p>
<pre class="screen">$ glance member-create &lt;image-uuid&gt; &lt;project-uuid&gt;</pre>
<p>Например:</p>
<pre class="screen">$ glance member-create 733d1c44-a2ea-414b-aca7-69decf20d810 \
    771ed149ef7e4b2b88665cc1c98f77ca</pre><p>Project 771ed149ef7e4b2b88665cc1c98f77ca will now have access
          to image 733d1c44-a2ea-414b-aca7-69decf20d810.</p></li></ol>
</div></div>
<div class="section">
<div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">
 <a id="delete_images"> </a>Удаление образов</h3>
</div></div></div>
<p>Для удаления образа,
<a id="d9e3998" class="indexterm"/> просто выполните:</p>
<pre class="screen">$ glance image-delete &lt;image uuid&gt;</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<table border="0" summary="Замечание"><tr><td rowspan="2" align="center" valign="top" width="25">
<img alt="[Замечание]" src="../common/images/admon/note.png"/></td><th align="left">Замечание</th></tr><tr>
<td align="left" valign="top">
<p>Удаление образа не влияет на экземпляры или моментальные снимки, которые основывались на 
этом образе.</p></td></tr></table>
</div></div>
<div class="section">
<div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">
 <a id="other_cli"> </a>Другие параметры CLI</h3>
</div></div></div>
<p>Полный набор опций можно найти с помощью:
<a id="d9e4007" class="indexterm"/></p>
<pre class="screen">$ glance help</pre>
<p>или в  
<a class="link" href="http://docs.openstack.org/cli-reference/content/glanceclient_commands.html" target="_top">
руководстве по интерфейсу командной строки</a>.</p>
</div>
<div class="section">
<div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">
 <a id="image_service_and_database"> </a>Служба образов и базы данных</h3>
</div></div></div>
<p>Единственное, что служба образов не хранит в базе данных, 
это сами образы. База данных службы образов имеет две основные таблицы:
<a id="d9e4016" class="indexterm"/>
<a id="d9e4019" class="indexterm"/></p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<p><code class="literal">images</code> (образы)</p></li><li class="listitem">
<p><code class="literal">image_properties</code> (свойства образов)</p></li></ul>
</div>
<p>Непосредственная работа с базой данных и выполнение SQL запросов может снабдить вас 
списками пользователей и сообщить об образах. Технически, вы можете обновлять 
свойства об образах непосредственно через базу данных, хотя это и не рекомендуется.</p>
</div>
<div class="section">
<div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">
 <a id="sample_image_database"> </a>Пример запросов к базе данных службы образов</h3>
</div></div></div>
<p>Один интересный пример заключается в изменении таблицы образов и 
владельца этого образа. Это можно легко сделать, если вы просто отображаете 
уникальный идентификатор (ID) хозяина. 
<a id="d9e4033" class="indexterm"/>
Данный пример идет на шаг дальше и отображает читаемое имя хозяина:</p>
<pre class="screen">mysql&gt; select glance.images.id,
              glance.images.name, keystone.tenant.name, is_public from
              glance.images inner join keystone.tenant on
              glance.images.owner=keystone.tenant.id;</pre>
<p>Другой пример заключается в отображении всех свойств для определенного образа:</p>
<pre class="screen">mysql&gt; select name, value from
              image_properties where id = &lt;image_id&gt;</pre>
</div></div>

<!----><script type="text/javascript" src="FooterAndSidebar.js">
</script><script type="text/javascript"><!--
document.write(FooterAndSidebar);//-->
</script>

</body></html>