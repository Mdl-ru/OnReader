<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:exsl="http://exslt.org/common" xmlns:ng="http://docbook.org/docbook-ng" xmlns:fb="http://ogp.me/ns/fb#">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link href="https://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet"/>
<title>Глава 0. Введение - Мастерство FreeBSD: ZFS для профессионалов</title>
<meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"/>
<meta name="mavenGroupId" content="www.mdl.ru"/>
<meta name="mavenArtifactId" content="AdvancedZFS"/>
<meta name="mavenVersionId" content="1.0.0"/>
<link rel="home" href="index.html" title="Мастерство FreeBSD: ZFS для профессионалов"/>
<link rel="up" href="index.html" title="Мастерство FreeBSD: ZFS для профессионалов"/>
<link rel="prev" href="Afterword.html" title="Заключение"/>
<link rel="next" href="Ch01.html" title="Глава 1. Окружения загрузки"/>
<meta name="git-sha" content=""/>
<meta name="buildTime" content=""/>
<script type="text/javascript">
            //The id for tree cookie
            var treeCookieId = "advanced-zfs";
            var language = "en";
            var w = new Object();
            //Localization
            txt_filesfound = 'Results';
            txt_enter_at_least_1_char = "You must enter at least one character.";
            txt_browser_not_supported = "Please enable JavaScript.";
            txt_please_wait = "Please wait. Search in progress...";
            txt_results_for = "Results for: ";
</script>
<style type="text/css">
            input {
            margin-bottom: 5px;
            margin-top: 2px;
            }

            .folder {
            display: block;
            height: 22px;
            padding-left: 20px;
            background: transparent url(../common/jquery/treeview/images/folder.gif) 0 0px no-repeat;
            }
</style>
<link rel="shortcut icon" href="../MdlLogo.gif" type="image/gif"/>
<link rel="stylesheet" type="text/css" href="../common/css/positioning.css"/>
<link rel="stylesheet" type="text/css" href="../common/css/custom.css"/>
<link rel="canonical" href="http://onreader.mdl.ru/FreeBSDMasteryZFS/content/index.html"/>
<!--[if IE]>
	<link rel="stylesheet" type="text/css" href="../common/css/ie.css"/>
<![endif]-->
<link rel="stylesheet" type="text/css" href="../common/jquery/theme-redmond/jquery-ui-1.8.2.custom.css"/>
<link rel="stylesheet" type="text/css" href="../common/jquery/treeview/jquery.treeview.css"/>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.11.0.min.js"><!----></script>
<script type="text/javascript" src="../common/jquery/jquery-ui-1.8.2.custom.min.js"><!----></script>
<script type="text/javascript" src="../common/jquery/jquery.cookie.js"><!----></script>
<script type="text/javascript" src="../common/jquery/treeview/jquery.treeview.min.js"><!----></script>
<link rel="stylesheet" type="text/css" href="http://cdn.jsdelivr.net/qtip2/2.2.0/jquery.qtip.min.css"/>
<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/qtip2/2.2.0/jquery.qtip.min.js">
<!--jQuery plugin for glossary popups. --></script><script type="text/javascript" src="search/htmlFileList.js"><!----></script>
<script type="text/javascript" src="search/htmlFileInfoList.js"><!----></script>
<script type="text/javascript" src="search/nwSearchFnt.js"><!----></script>
<script type="text/javascript" src="search/stemmers/en_stemmer.js">
<!--//make this scalable to other languages as well.--></script>
<script type="text/javascript" src="search/index-1.js"><!----></script>
<script type="text/javascript" src="search/index-2.js"><!----></script>
<script type="text/javascript" src="search/index-3.js"><!----></script>
<script type="text/javascript">
	    var _gaq = _gaq || [];
	    _gaq.push(['_setAccount', 'UA-17511903-1']);
	    
	    _gaq.push(['_setDomainName', '.openstack.org']);	        
</script>
<script type="text/javascript" src="../common/ga.js"><!----></script>
<script language="javascript" src="/js/common.js"></script>
<link rel="stylesheet" href="../common/css/googlecode.css">
<script src="../common/highlight.pack.js"></script>
</head>
<body>
<!----><script type="text/javascript"><!--
hljs.initHighlightingOnLoad();
HeaderName = 'Глава 0. Введение';
PrevRef = 'Afterword.html';
UpRef = 'index.html';
NextRef = 'Ch01.html';//-->
</script>
<!----><script type="text/javascript" src="HeaderAndToolbar.js">
</script><script type="text/javascript"><!--
document.write(HeaderAndToolbar); //-->
</script>
<div id="content">
 <div class="part">
  <div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title">
   Глава 0. Введение</h1>
  </div></div></div>

  <div class="toc"><p><strong>Содержание</strong></p>
   <dl>
   <dt><span class="chapter"><a href="Ch00.html">0. Введение</a></span></dt>
   <dd><dl>
     <dt><span class="chapter"><a href="Ch00.html#01">Предварительные требования</a></span></dt>
     <dt><span class="chapter"><a href="Ch00.html#02">Практический опыт ZFS</a></span></dt>
     <dd><dl>
       <dt><span class="chapter"><a href="Ch00.html#0201">Управление пространством</a></span></dt>
       <dt><span class="chapter"><a href="Ch00.html#0202">Закрепление типа VDEV</a></span></dt>
       <dt><span class="chapter"><a href="Ch00.html#0203">Важность меток</a></span></dt>
     </dl></dd>
     <dt><span class="chapter"><a href="Ch00.html#03">Пометка дисков</a></span></dt>
     <dd><dl>
       <dt><span class="chapter"><a href="Ch00.html#0301">Метка GPT (ручная)</a></span></dt>
       <dt><span class="chapter"><a href="Ch00.html#0302">Метка GPTID (автоматическая)</a></span></dt>
       <dt><span class="chapter"><a href="Ch00.html#0303">Метка идентификации диска (автоматическая)</a></span></dt>
       <dt><span class="chapter"><a href="Ch00.html#0304">Glabel (ручная)</a></span></dt>
     </dl></dd>
     <dt><span class="chapter"><a href="Ch00.html#04">DTrace</a></span></dt>
     <dt><span class="chapter"><a href="Ch00.html#05">Обзор книги</a></span></dt>
   </dl></dd>
   </dl>
  </div>
   <p>Z файловая система, или ZFS это сложная зверюга, но это в то же время самый мощный инструмент в Бэтменском 
   поясе инструментов системного администратора. Эта книга попытается прояснить некую магию, которая делает 
   ZFS такой энергичной и предоставляет вам веский, действенный интеллект пока вы сражаетесь со своими 
   драконами хранения.</p>
   <p>ZFS содержит более 100 &quot;лет конструирования&quot; усилий ряда лучших умов в этой индустрии. 
   Хотя она и имеет конкурентов, например B-Tree файловую систему (BTRFS), этим конкурентам предстоит ещё много чего 
   сделать. А ZFS несётся тем временем вперёд каждый день.</p>
   <p>Данная книга окунёт вас в наиболее сложные и тайные разделы управления ZFS. Если вы хотите знать почему 
   единственный гигабайт данных заполняет ваше 2ГБ устройство, если вы хотите автоматически обновлять свои 
   возможности аварийного восстановления или вы просто хотите использовать среды загрузки своего ноутбука, 
   <span class="emphasis"><em>Мастерство FreeBSD: ZFS для профессионалов</em></span> предназначена вам.</p>
   <p>Всё, о чем пишется в этой книге, применимо в общем смысле к OpenZFS. Мы используем FreeBSD в качестве 
   эталонной платформы, однако механизм применения OpenZFS не сильно подвержен влиянию платформ.</p>
  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="01"> </a>Предварительные требования</h3>
   </div></div></div>
   <p>Заголовок этой книги включает слово &quot;Advanced&quot; (для профессионалов). Мы ожидаем, что вы 
   знаете пару вещей, прежде чем можете начать пользоваться ею. Простейшим ответом будет, что вам следует 
   прочитать две более ранние книги Мастерство FreeBSD (<span class="emphasis"><em>FreeBSD Mastery</em></span>),
   озаглавленные Хранение по существу (<span class="emphasis"><em>Storage Essentials</em></span>) и 
   <a class="link" href="http://onreader.mdl.ru/FreeBSDMasteryZFS/content/index.html" target="_top">ZFS</a>.
   Но вы можете уже знать о чём эти книги, поэтому здесь некоторые подробности о том что вы должны взять с собой 
   для четния.</p>
   <p>Вы должны быть знакомы с уровнями управления хранением FreeBSD, GEOM. В платформах не-FreeBSD вы 
   можете применять диски и разделы устройств для ZFS. Всегда применяйте ZFS на диске или разделах устройств, 
   никогда не используйте RAID или программные устройства.</p>
   <p>Мы предполагаем, что вы знакомы с пулами и наборами данных ZFS. Вы знаете как добавлять VDEV в пул и 
   понимаете почему вы не можете добавить изолированный диск в свой RAID-Z. Вы можете делать снимки и 
   создавать клоны.</p>
   <p>Если вы хотите применять поддержку шифрования ZFS, вы должны понимать GELI кодирование FreeBSD. 
   (Вы можете использовать GBDE, если вы полагаетесь на шифрование для защиты человеческой жизни, однако 
   встроенной поддержки GELI вполне достаточно для большинства из нас. Кроме того, GELI имеет преимущества 
   AES-NI аппаратного ускорения шифрования в современных ЦПУ.)</p>
  </div>
   
  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="02"> </a>Практический опыт ZFS</h3>
   </div></div></div>
   <p>Хотя вы и можете получить все необходимые знания по ZFS из общедоступной документации, они не дадут вам 
   практического опыта ZFS, который мы обсуждали в предыдущих книгах. Как и со многими прочими вещами в 
   технологии, хорошая вещь о практическом опыте состоит в том, что их существует очень много на выбор.</p>
   <p>Мы обсуждаем здесь некоторые вещи из нашего практического опыта. Возможно, эта практика лучше вашей, и вы 
   радостно примете её. Может быть она высветит некоторые улучшения в существующей у вас практике. Даже 
   если ваш практический опыт сдувает наш напрочь, он по крайней мере отобразит наши пристрастия, 
   поэтому вы узнаете как мы подходим к проблемам управления хранением.</p>

   <div xmlns="" class="titlepage"><div><div>
    <h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0201"> </a>
	<span  style="color:#FEFEFE; background-color:#888888; padding:0.5em;">Управление пространством </span></h4>
   </div></div></div>
   <p>В файловых системах с копированием при записи (copy-on-write) удаление файлов потребляет пространство.
   Привыкшие к обычным файловым системам системные администраторы могли слышать это, когда они начинали 
   работать с ZFS, однако в действительности не усвоили этого, пока они не выйдут за пределы диска и не 
   получат противный удар. Обладая подходом пула к ёмкости, ZFS требует всё больше и больше времени для 
   хранения дополнительных блоков данных. Производительность ухудшается. Хотя разработчики ZFS придерживались 
   уменьшения воздействия фрагментации на производительность, оно становится всё более и более значимым по 
   мере приближения пула к 100% использованию.</p>
   <p>Восстановление из полностью заполненного пула страшно трудное. Чтобы предотвратить использование 
   всего пространства, или, по крайней мере предоставлять предупреждения вперёд по времени, создавайте 
   <span class="emphasis"><em>резервирования</em></span>.</p>
   <p>В мдеале вам следует создать резерв 20% ёмкости вашего пула. Вы всегда можете уменьшить уменьшить 
   резерв, купив время, которое вы отработаете над добавлением большей ёмкости или удаление старых данных. 
   Последняя вещь, которую вы захотите получить это неожиданный выход за пределы пространства. Именно предложение 
   вашей Unix File System (UFS), в которой <span class="term"><strong class="userinput"><code>root</code></strong></span>
   может воспользоваться самыми последними процентами дискового пространства, может дать вам мягкую посадку.</p>
   <p>В данном пуле 1ТБ мы создадим новый набор данных с 200ГБ refreservation.</p>
	   <pre class="screen"><code>
# zfs create -o refreservation=200G mypool/reserved
 	   </code></pre>
   <p>Каждый раз, когда вы исследуете проблемы пространства в наборе данных ZFS, вспоминайте о команде 
   <span class="term"><code>zfs get space</code></span>. Вы увидите все связанные с пространством свойства 
   в одном удобном отображении.</p>
	   <pre class="screen"><code>
# zfs get space zstore/usr
NAME        PROPERTY              VALUE       SOURCE
zstore/usr  name                  zstore/usr  -
zstore/usr  available             5.00T       -
zstore/usr  used                  367M        -
zstore/usr  usedbysnapshots       0           -
zstore/usr  usedbydataset         140K        -
zstore/usr  usedbyrefreservation  0           -
zstore/usr  usedbychildren        367M        -
 	   </code></pre>
   <p>Хотя <span class="term"><code>zfs get space</code></span> и не освободит вам пространство, это простейший 
   способ найти куда оно подевалось.</p>

   <div xmlns="" class="titlepage"><div><div>
    <h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0202"> </a>
	<span  style="color:#FEFEFE; background-color:#888888; padding:0.5em;">Закрепление типа VDEV </span></h4>
   </div></div></div>
   <p>Как уже обсуждалось на протяжении всей книги <a class="link" 
   href="http://onreader.mdl.ru/FreeBSDMasteryZFS/content/index.html" target="_top">ZFS</a>, выбор правильного 
   типа VDEV при создании вашего пула является наиболее важным выполняемым вами решением. Он влияет на 
   производительность вашего пула, а также на расширение возможностей.</p>
   <p>Исследование Pâris, Amer, Long и Schwarz (<a class="link" href="http://arxiv.org/ftp/arxiv/papers/1501/1501.00513.pdf" 
   target="_top">http://arxiv.org/ftp/arxiv/papers/1501/1501.00513.pdf</a>) определило, что построение 
   дискового массива, который может обслуживаться четыре года без вмешательства человека, требует тройного 
   избыточного кодирования RAID. Двойное кодирование, даже с неограниченным числом запасных частей, не может 
   поддерживать 99.999% (пять девяток) надёжности на протяжении четырёхлетнего периода.</p>
   <p>Объединяйте это соображение с имеющимся у вас оборудованием и своими ожидаемыми потребностями 
   хранения в будущем.</p>

   <div xmlns="" class="titlepage"><div><div>
    <h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0203"> </a>
	<span  style="color:#FEFEFE; background-color:#888888; padding:0.5em;">Важность меток </span></h4>
   </div></div></div>
   <p>Помечая устройства вы сохраните себя от головной боли в будущем. Помечайте свои диски и разделы перед 
   их добавлением в пул - или, действительно, используйте их таким образом по причинам, которые мы 
   обсудим в этом разделе.</p>
   <p>Давайте рассмотрим случай неудачливого приятеля Джуда, который создал пул с пустыми именами устройств.
   Когда устройство отказало, он перезагрузился до замены диска. Его пул выглядел несколько иначе, чем он 
   ожидал.</p>
	   <pre class="screen"><code>
# zpool status
pool: data
state: DEGRADED
status: One or more devices is currently being resilvered. The
        pool will continue to function, possibly in a degraded
        state.
action: Wait for the resilver to complete.
 scan:  resilver in progress since Sat Apr 11 17:49:38 2015
        62.0M scanned out of 1.55T at 5.16M/s, 87h40m to go
        9.81M resilvered, 0.00% done

config:
NAME                   STATE     READ WRITE CKSUM
data                   DEGRADED     0     0     0
 mirror-0              DEGRADED     0     0     0
  spare-0              UNAVAIL      0     0     0
   5694975301095445325 FAULTED      0     0     0  was /dev/da1
  da7                  ONLINE       0     0   856  (resilvering)
  da14                 ONLINE       0     0     0
 mirror-1              ONLINE       0     0     0
  da1                  ONLINE       0     0     0
  da13                 ONLINE       0     0     0
 	   </code></pre>
   <p>Первоначально это пул состоял из двух зеркал: <span class="term"><code>mirror-0</code></span> из 
   <span class="term"><code>da1</code></span> и <span class="term"><code>da15</code></span>, а также 
   <span class="term"><code>mirror-1</code></span> из <span class="term"><code>da2</code></span> и 
   <span class="term"><code>da14</code></span>. Диск <span class="term"><code>da1</code></span> 
   оказал.</p>
   <p>FreeBSD динамично назначает узлы дисковых устройств при загрузке. Потеряв <span class="term"><code>da1</code></span>,
   FreeBSD перенумеровала оставшиеся дисковые устройства сдвинув номер на один вниз. Диск 
   <span class="term"><code>da15</code></span> стал <span class="term"><code>da14</code></span>, 
   <span class="term"><code>da14</code></span> стал <span class="term"><code>da13</code></span> и, что 
   хуже всего, <span class="term"><code>da2</code></span> стал <span class="term"><code>da1</code></span>.</p>
   <p>Поэтому <span class="term"><code>mirror-1</code></span> содержит <span class="term"><code>da1</code></span> - 
   который был совсем не тем же диском <span class="term"><code>da1</code></span>, который отказал. 
   <span class="term"><code>mirror-0</code></span> применил свой запасной диск (<span class="term"><code>da7</code></span>) 
   в месте, в котором использовался диск с именем <span class="term"><code>da1</code></span>. Поскольку 
   неудачливый приятель Джуда поместил диск назад на место отказавшего <span class="term"><code>da1</code></span>, 
   то <span class="term"><code>da7</code></span> стал <span class="term"><code>da1</code></span>.</p>
   <p>ZFS не использует имена дисков FreeBSD для поиска участников VDEV, вместо этого полагаясь свои собственные 
   метки дисков с глобально уникальным идентификатором (GUID, Globally Unique IDentifier). ZFS может определить 
   свой диск вне зависимости от того, где операционная система разместила свой узел устройства. А операционная 
   система даже и не беспокоится- она нашла диск для вас и смонтировала вашу файловую систему; чего ещё вы 
   хотите?</p>
   <p>Однако, это может легко ввести оператора человека в заблуждение. Внезапно <span class="term"><code>da1</code></span> 
   является не отказавшим устройством, а прекрасно работающим устройством, да ещё совсем и в другом VDEV! 
   После того, как оператор заменит устройство и перезагрузит машину, заменённый диск, почти несомненно, 
   станет снова <span class="term"><code>da1</code></span>. Все узлы устройств сдвинутся назад в свои 
   первоначальные значения. По окончанию всего этого системный администратор не имеет идей какой диск кем 
   является. Единственная имеющаяся у него мысль, что он должен сильно напиться.</p>
  </div>
   
  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="03"> </a>Пометка дисков</h3>
   </div></div></div>
   <p>FreeBSD предоставляет различные способы пометки диска или раздела. Некоторые являются автоматическими, 
   а некоторые управляются пользователем. Каждый из них имеет преимущества и недостатки. Одно устройство 
   может иметь множество меток.</p>
   <p>Когда осуществляется доступ по одной метке, другая метка указывающая на то же самое устройство засыхают 
   и становятся недоступными. Это предотвращает доступ к одному устройству по множеству имён.</p>
   <p>Все автоматически создаваемые метки активируются по умолчанию. Если вы хотите применять 
   устанавливаемые вручную метки, то лучше запретить эти методы установки вручную. {<span class="emphasis"><em>Прим. 
   пер.: так в тексте. Вопрос авторам задан.</em></span>}</p>

   <div xmlns="" class="titlepage"><div><div>
    <h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0301"> </a>
	<span  style="color:#FEFEFE; background-color:#888888; padding:0.5em;">Метка GPT (ручная) </span></h4>
   </div></div></div>
   <p>Если диск разбивается на разделы при помощи GUID Partition Table (GPT), каждый раздел может содержать 
   текстоовую метку по своему выбору. Это является предпочтительным методом пометки дисков для обоих 
   авторов.</p>
   <p>Используйте <span class="term"><code>gpart(8)</code></span> для создания и пометки нового раздела.</p>
	   <pre class="screen"><code>
# gpart add -t freebsd-zfs -l zfs-mirror-1 da2
 	   </code></pre>
   <p>Вот мы изменяем свою метку для существующего 2го раздела.</p>
	   <pre class="screen"><code>
# gpart modify -i 2 -l f01-serialnum da2
 	   </code></pre>
   <p>Устанавливаемые вручную метки позволяют вам идентифицировать диски по таким характеристикам, как 
   физическое местоположение и серийный номер.</p>
   <p>Если вы используете метки GPT, мы рекомендуем запретить GPTID и дисковые ID метки.</p>

   <div xmlns="" class="titlepage"><div><div>
    <h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0302"> </a>
	<span  style="color:#FEFEFE; background-color:#888888; padding:0.5em;">Метка GPTID (автоматическая) </span></h4>
   </div></div></div>
   <p>При схеме с разделами GPT каждый раздел имеет уникальный GUID. Система меток GPT ID применяет GUID для 
   идентификации разделов. Проблема состоит в том, что эти метки имеют мало значения для человеческого 
   восприятия. Посмотрев на несколько примеров, вы сможете убедиться, что может оказаться сложным заметить 
   различия.</p>
	   <pre class="screen"><code>
ada0p1: /dev/gptid/b305e4ff-b889-11e5-bace-002590db872e
ada1p1: /dev/gptid/b329ff70-b889-11e5-bace-002590db872e
ada1p2: /dev/gptid/b33db4ac-b889-11e5-bace-002590db872e
 	   </code></pre>
   <p>Если только последние несколько символов самого первого сегмента в действительности отличны, достаточно 
   легко запутаться.</p>
   <p>Если ZFS просматривает часть пула с метками GUID до того, как он увидит что тот же пул применяет другие 
   метки, он применяет метки GPTID. Это скроет аккуратно создаваемые вами вручную метки. Запретите метки 
   GPTID при загрузке добавив следующую строку в <span class="term"><code><em>/boot/loader.conf</em></code></span>.</p>
	   <pre class="screen"><code>
kern.geom.label.gptid.enable=0
 	   </code></pre>
   <p>По умолчанию FreeBSD делает метки GPT ID доступными.</p>

   <div xmlns="" class="titlepage"><div><div>
    <h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0303"> </a>
	<span  style="color:#FEFEFE; background-color:#888888; padding:0.5em;">Метка идентификации диска (автоматическая) </span></h4>
   </div></div></div>
   <p>В то время как метки GPT и GPTID идентифицируют раздел, метки Disk Ident (или <span class="emphasis"><em>diskid</em></span>)
   идентифицируют диск целиком. Имя устройства основывается на серийном номере диска, который вполне подходит
   для этого. К сожалению, любые специализированные символы в этом серийном номере - в особенности, пробелы - 
   кодируются. Это создаёт весьма уродливые имена устройств. Кроме того, так как метка идентифицирует весь диск, 
   а не раздел, добавляется в конец часть раздела имени устройства (p3) и может быть трудно ухватить имя этого 
   устройства.</p>
	   <pre class="screen"><code>
/dev/diskid/DISK-07013121E6B2FA14
/dev/diskid/DISK-%20%20%20%20%20WD-WCC131365642
/dev/diskid/DISK-%20%20%20%20%20%20%20%20%20%20%20%20Z300HTCE
 	   </code></pre>
   <p>Такие автоматически создаваемые метки могут быть запрещены для блокирования их применения ZFS вместо 
   ваших меток GPT. Добавьте в <span class="term"><code><em>/boot/loader.conf</em></code></span> следующее:</p>
	   <pre class="screen"><code>
ern.geom.label.disk_ident.enable=0
 	   </code></pre>
   <p>Многие люди приводят сильную аргументацию в пользу меток diskid. Авторы не хотят сказать, что эта 
   аргументация ошибочна. Мы скажем, что метки diskid доставляют нам обоим головную боль.</p>
   <p>По умолчание метки diskid в FreeBSD разрешены.</p>

   <div xmlns="" class="titlepage"><div><div>
    <h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0304"> </a>
	<span  style="color:#FEFEFE; background-color:#888888; padding:0.5em;">Glabel (ручная) </span></h4>
   </div></div></div>
   <p>В добавление ко всем прочим типам меток вы можете также создавать метку GEOM, сохраняемую в самом 
   последнем секторе диска или раздела. Эти метки определяются в специфичном для GEOM формате и называются 
   <span class="emphasis"><em>glabel</em></span>. Преимущество таких устанавливаемых пользователем меток 
   состоит в том, что нет необходимости применять формат GPT, поэтому они могут работать и в дисках формата 
   MBR, и в голых дисках без каких бы то ни было разделов. Glabel используют самый последний сектор 
   поставщика.</p>
   <p>Создадим и просмотрим <span class="emphasis"><em>glabel</em></span> при помощи 
   <span class="term"><code>glabel(8)</code></span>.</p>
	   <pre class="screen"><code>
# glabel label -v mylabel /dev/ada0p2
Metadata value stored on /dev/ada0p2.
Done.
# glabel status
         Name  Status  Components
 gpt/gptboot0     N/A  ada0p1
label/mylabel     N/A  ada0p2
 gpt/zfs0         N/A  ada0p3
 	   </code></pre>
   <p>Это теперь устройство <span class="emphasis"><em>/dev/label/mylabel</em></span></p>
   <p>Все метки должны быть уникальными. Хотя вы и можете применять одну и ту же метку для множества 
   дисков, отображаться будет только одна.</p>
  </div>
   
  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="04"> </a>DTrace</h3>
   </div></div></div>
   <p>Настройка на верхнем уровне некоторых свойств ZFS требует применения DTrace, программы, для отслеживания 
   поведения и производительности программного обеспечения.</p>
   <p>Применение DTrace для ZFS со знанием дела требует понимания внутреннего устройства ядра. Данная книга 
   не является книгой ни по DTrace, ни по внутреннему устройству ядра. Прихватывание существующих сценариев 
   и их выполнение не требует ничего.</p>
   <p>Мы будем поощрять вас использовать вывод подобных сценариев DTrace как для решения ваших проблем ZFS, 
   так и точку входа для выбора предмета изучения внутреннего устройства ядра. Вы не обязательно должны 
   быть программистом, однако профессиональный системный администратор должен развивать понимание того, 
   <a class="link" href="http://onreader.mdl.ru/HowLinuxWorks2/content/index.html" target="_top">как 
   работает система</a>.</p>
   <p>Работающие вслепую сценарии в точности соответствуют &quot;мистическому ведению дел&quot;, против которого 
   с напором выступает Лукас. Тем не менее, здесь мы опишем как именно выполнять сценарий DTrace вслепую.</p>
   <p>DTrace применяет модули ядра для исследования программного обеспечения, которые наблюдают за поведением 
   программных средств: <span class="term"><code><em>dtrace.ko</em></code></span> и 
   <span class="term"><code><em>dtraceall.ko</em></code></span>. Вы можете загружать их автоматически при загрузке 
   в <span class="term"><code><em>loader.conf</em></code></span>. Если эти модули ядра не найдены, программа 
   <span class="term"><code>dtrace(1)</code></span> автоматически загрузит их когда вы её выполните первый раз.</p>
   <p>Вы должны выполнять <span class="term"><code>dtrace</code></span> с правами 
   <span class="term"><strong class="userinput"><code>root</code></strong></span>.</p>
   <p>Скопируйте свой сценарий в какой-нибудь файл. Затем выполните <span class="term"><code>dtrace -s</code></span>
   с этим сценарием в качестве аргумента.</p>
   <p>Чтобы прервать сценарий, нажмите <span class="term"><code>CTRL-C</code></span>.</p>
   <p>Вы можете загрузить все приведённые в этой книге сценарии DTrace из репозитория GitHub Лукаса, 
   ссылка на который имеется на <a class="link" href="http://zfsbook.com/" target="_top">zfsbook.com</a></p>
   <p>Системный администратор с пониманием того как работает его ядро сможет решать проблемы более быстро и 
   правильно. В качестве обзора внутреннего устройства ZFS прихватите последнюю редакцию 
   <a class="link" href="http://onreader.mdl.ru/DesignAndImplementationFreeBSD/content/Ch10.html" 
   target="_top">Проектирования и реализации операционной системы FreeBSD</a> (The Design and Implementation 
   of the FreeBSD Operating System, Addison-Wesley Professional,2014, кое- кто из авторов TD&amp;IotFOS 
   использует наши книги по ZFS для изучения написанного ими кода, так что всё уравнивается.)
   Аналогично, DTrace является мощным инструментом, стоящим его обучения и понимания. Мы рекомендуем книгу 
   <span class="emphasis"><em>Gregg и Mauro, DTrace: Dynamic Tracing in Oracle Solaris, Mac OS X, and FreeBSD</em>
   <a class="link" href="http://www.dtracebook.com/index.php/Main_Page" target="_top">Prentice Hall, 2011</a></span>.</p>
  </div>
   
  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="05"> </a>Обзор книги</h3>
   </div></div></div>
   <p><a class="link" href="Ch00.html" target="_top">Глава 0</a> является данным Введением.</p>
   <p><a class="link" href="Ch01.html" target="_top">Глава 1, Окружения загрузки</a> проведёт вас сквозь 
   применение снимков ZFS для создания сред загрузки в стиле Sloaris. Окружения загрузки делают для вас 
   возможными без головной боли обратимые изменения, такие как обновления. Вы даже можете одновременно иметь 
   множество установленных версий FreeBSD. Когда у вас есть одновременно установленное множество версий 
   FreeBSD, вы будете удивляться тому, как вы могли до этого жить без них.</p>
   <p><a class="link" href="Ch09.html" target="_top">Глава 2, Передача полномочий и джейлы</a> охватывает 
   схемы внутренних полномочий. ZFS может позволить вам выбирать пользователей и группы с полномочиями для 
   выполнения операций, которые обычно требуют доступа с правами <span class="term"><strong class="userinput"><code>root</code></strong></span>, 
   например, таких как создание снимков и клонирование.</p>
   <p><a class="link" href="Ch02.html" target="_top">Глава 3, Совместное использование наборов данных</a> описывает 
   функциональность совместного сетевого применения файлов. ZFS FreeBSD интегрирована с Network File System, а также 
   крайне полезна для устройств iSCSI.</p>
   <p><a class="link" href="Ch03.html" target="_top">Глава 4, Репликация</a> обучает тому, как реплицировать наборы 
   данных ZFS на другие машины. Репликации могут позволить вам подхватывать массивные объёмы данных и перемещать их 
   поперёк страны или вокруг планеты, сохраняя при этом их актуальность, даже без уведомления пользователей.</p>
   <p><a class="link" href="Ch04.html" target="_top">Глава 5, Тома ZFS</a> обсуждает некоторые тонкие детали 
   создания и применения блочных устройств поверх пула ZFS.</p>
   <p><a class="link" href="Ch05.html" target="_top">Глава 6, Профессиональное оборудование</a> предназначена для 
   людей, которые вдействительности имеют большие массивы данных. Если слова &quot;множественность путей SCSI&quot; 
   проникли в ваше сердце, или если вы имеете мысли о том, что такое NVMe, эта глава для вас.</p>
   <p><a class="link" href="Ch06.html" target="_top">Глава 7, Кэширование</a> охватывает все возможные механизмы 
   кэширования. Вы изучите кэш адаптивной замены и все его варианты, кэширование чтения и записи, а также 
   кэширование дискового пула.</p>
   <p><a class="link" href="Ch07.html" target="_top">Глава 8, Производительность</a> глубоко погрузится в то, 
   как ZFS выполняется в различных окружениях и как определять что из менения системы могут улучшить 
   производительность.</p>
   <p><a class="link" href="Ch08.html" target="_top">Глава 9, Тонкая настройка</a> обсуждает как регулировать 
   лучшим образом работу ZFS в вашей среде, имея надежду в отсутствии необходимости приобретения дополнительного 
   и более дорогостоящего оборудования.</p>
   <p><a class="link" href="Ch10.html" target="_top">Глава 10, Попурри ZFS</a> включает группу коротких 
   советов по применению ZFS.</p>
   <p>Для тех, кто читает введение в книги: наши поздравления. Мы надеемся, вы что- то узнали, или, по крайней мере, 
   были предупреждены о некоторых важных подробностях. Давайте перейдём к средам загрузки!</p>
  </div>
   
 </div>

<!----><script type="text/javascript" src="FooterAndSidebar.js">
</script><script type="text/javascript"><!--</div id="content"> is inside next code
document.write(FooterAndSidebar);//-->
</script>

</body></html>