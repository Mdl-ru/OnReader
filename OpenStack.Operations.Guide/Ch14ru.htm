<html>
<head>
   <link rel="icon" href="/i/MdlLogo.gif" type="image/gif">
   <title>Глава 14. Резервное копирование и восстановление. Руководство по эксплуатации OpenStack.</title>
   <meta name="Keywords" content="OpenStack, Cloud computing, Swift, RESTful, Object Storage, Ceph, CORS, CNAME lookup, Domain remap, Health check, Rate limiting, Bulk delete, Container qoutas, account qoutas, TempURL, Static Web, Form post, recon, Swift origin server, Bulk archive auto-extraction">
   <meta name="Description" content="Глава 14. Резервное копирование и восстановление. Руководство по эксплуатации OpenStack.">
   <meta name="Robots" content="INDEX, FOLLOW">
   <meta name="Author" content="Module-Projects,Ltd">
   <meta name="Copyright" content="Copyright 1998..2014 Module-Projects,Ltd">
   <meta http-equiv="Pragma" content="no-cache">
<script language="javascript" src="/css/v.0/mdlcss.js"></script>
<style type="text/css" media="screen, print">@import url("i/global-20140610.css");</style>
<script language="javascript" src="http://www.mdl.ru/usd.js"></script>
	<script language="javascript" src="http://www.mdl.ru/js/common.js"></script>
	<script language="javascript" src="http://www.mdl.ru/Solutions/ABC.js"></script>
</head>
<body>

<table class="bg_White" width="1024" align="center" valign="top" border="0" cellpadding="0" cellspacing="0"><tbody>
<tr>
<td>
<table width="100%" border="0" cellpadding="2" cellspacing=0 class="bg_White"><tbody>
<tr>
<td width="150" valign="top" align="center"><img src="http://www.mdl.ru/RMC9.jpg" border=0 /></td>
<td width="724" valign="bottom" align="center">
<a class="item-t" href="http://www.mdl.ru"><img src="http://www.mdl.ru/i/MdlBigLogo.gif" border="0"></a><br/>
<a class="item-t" href="http://www.mdl.ru">С 1991 года на компьютерном рынке России</a>
</td>
<td align="center" valign="bottom">
<a class="item-t" href="javascript:tocall()" onmouseover="this.href=mail"><img src="http://www.mdl.ru/i/9563499.gif" border="0" alt="e-mail" /><br/><br/>т.: 676 0965, 676 0396<br/>Москва, Сосинская ул. 43, <br/>м. Волгоградский проспект</a>
</td>
</tr>
<tr>
<td class="big_16y" colspan="3" align="center"><a href="index.htm">Руководство по эксплуатации OpenStack</a></td>
</tr>
<tr><td colspan="2">


<h2 align="right">ГЛАВА 14</h2>
<hr />
<h1 id="Chapter_14" align="right">Резервное копирование и восстановление</h1>

<em>Пользуйтесь переводом <strong>существенно переработанной и дополенной <a href="http://onreader.mdl.ru/openstack-ops/content/backup_and_recovery.html">2й редакции</a></strong> (12-дек-2014),<br />
находящейся теперь и в режиме <a href="http://docs.openstack.org/openstack-ops/content/backup_and_recovery.html">постоянно обновляемой документации</a> <br />
(последняя пока доступна только на англ.яз.).</em><br />
<p></p>

<p>При создании вашей политики резервного копирования вашего OpenStack лучшей практикой будет стандартное резервное копирование.
 Например, проблема того, как часто вы должны делать резервные копии своих данных тесно связана с тем, 
 как быстро вы должны восстановить утраченные данные.</p>
<p><img src="i/Tip.jpg" alt="Tip" /> Если вы совсем не должны иметь никаких потерь данных, вам, 
помимо резервного копирования, следует сосредоточиться на высокой доступности (High Availability).</p>
<p>Другие соображения по поводу резервного копирования включают в себя:<ul>
 <li>Сколько резервных копий стоит хранить?
 <li>Должны ли резервные копии храниться за пределами площадки?
 <li>Как часто стоит проверять резервные копии?</ul></p>
<p>Политика восстановления (или, по крайней мере тестирование восстановления) является не менее важной, чем политика резервного копирования.</p>

<h2 id="Ch1401">Что подлежит резервному копированию</h2>
<p>Поскольку OpenStack состоит из многих компонентов и перемещающихся частей, резервное копирование критически важных данных достаточно простое.</p>

<p>В этой главе описывается только как выполнять резервное копирование файлов конфигурации и баз данных, 
которые необходимы для различных компонентов OpenStack.
  В данном разделе не описывается, как выполнять резервное копирование объектов внутри систем хранения объектов или данных, 
  содержащихся внутри систем блочного хранения.
  Как правило, эти области отдаются на откуп пользователю для самостоятельного резервного копирования.</p>

<h2 id="Ch1402">Резервное копирование баз данных</h2>
<p>Приводимый пример архитектуры OpenStack определяет контроллер облака в качестве сервера MySQL.
  Этот сервер MySQL содержит базы данных для Nova, Glance, Cinder и Keystone.
  Поскольку все эти базы данных находятся в одном месте, создание резервной копии базы данных очень простое:
<br /><code>
# mysqldump --opt --all-databases &gt;<br />
 &nbsp; &nbsp; &nbsp; &nbsp; openstack.sql<br />
</code></p>
<p>Если вы хотите выполнить резервное копирование только одной базы данных, вы можете вместо приведенного выше примера выполнить нечто типа:
 <br /><code>
# mysqldump --opt nova &gt; nova.sql<br />
</code><br />
где <code>nova</code> является базой данных, подлежащей резервному копированию.</p>
<p>Вы легко можете автоматизировать процесс путем создания задания <code>cron</code>, которое ежедневно выполняет следующий сценарий:
<br /><code>
#!/bin/bash<br />
backup_dir=&quot;/var/lib/backups/mysql&quot;<br />
filename=&quot;${backup_dir}/mysql-`hostname`-`eval date +%Y%m%d`.sql.gz&quot;<br />
# Dump the entire MySQL database<br />
/usr/bin/mysqldump --opt --all-databases | gzip &gt; $filename <br />
# Delete backups older than 7 days<br />
find $backup_dir -ctime +7 -type f -delete<br />
</code></p>
<p>Приведенный сценарий выгружает всю базу данных MySQL и удаляет любые резервные копии старше 7 дней.</p>

<h2 id="Ch1403">Резервное копирование файловой системы</h2>
<p>В данном разделе обсуждается, какие файлы и каталоги должны подвергаться регулярному резервному копированию со стороны службы.</p>

<h3 id="Ch140301">Compute</h3>
<p>Каталог <code>/etc/nova</code> и в контроллере облака, и в вычислительных узлах должен обеспечиваться регулярным резервным копированием.</p>
<p>Если у вас существуют журналы, помещенные в централизованном месте, нет необходимости выполнять резервное копирование <code>/var/log/nova</code>.</p>
<p><code>/var/lib/nova</code> является еще одним важным каталогом для резервного копирования.
 Исключением из этого правила является подкаталог <code>/var/lib/nova/instances</code> на вычислительных узлах.
 Этот подкаталог содержит KVM образы запущенных на исполнение экземпляров.
 Вам следует создавать резервную копию этого подкаталога только если у вас есть необходимость создавать резервные копии всех экземпляров.
 В большинстве случаев в этом нет необходимости, однако это может меняться от облака к облаку и ваших уровней служб.
 Также имейте в виду, что создание резервной копии запущенного экземпляра KVM может привести к тому, что он не 
 сможет загружаться надлежащим образом, будучи восстановленным из резервной копии.</p>

<h3 id="Ch140302">Каталог образов и доставка</h3>
<p></p>
<p></p>
<p></p>
<p></p>

<h3 id="Ch140303"></h3>
<p></p>

<h3 id="Ch140304"></h3>
<p></p>

<h3 id="Ch140305"></h3>
<p></p>

<h2 id="Ch1404"></h2>
<p></p>

<table width="100%" border="0" cellpadding="2" cellspacing=0 class="bg_White"><tbody><tr>
 <td align="left"><a href="Ch13ru.htm">Глава 13</a></td>
 <td align="center"><a href="index.htm">Оглавление</a></td>
 <td align="right"><a href="Ch15ru.htm">Глава 15</a></td>
</tr><tr><td colspan="3" style="border-bottom: thin solid;">&nbsp;</tr>
<tr><td colspan="2" valign="top">Перевод: Copyright ©&nbsp;2014 &nbsp;<img src="/i/mdl-reg.jpg" widht="35" height="12" style="border-style: none;">.<br>
All rights reserved.<br />
Ссылки обязательны (Refs and links obligatory).</td>
<td valign="top" align="right"><em><a href="http://www.mdl.ru">http://www.mdl.ru</a></em></td></tr>
</tbody></table>


<td align="right" valign="top">
<script language="javascript">
WriteABC('GPFS');
//--></script>
</tr>
</tbody></table>
</tbody></table>
</body>
</html>
