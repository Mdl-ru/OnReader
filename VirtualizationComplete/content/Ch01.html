<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:exsl="http://exslt.org/common" xmlns:ng="http://docbook.org/docbook-ng" xmlns:fb="http://ogp.me/ns/fb#">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link href="https://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet"/>
<title>Книга 1. Proxmox VE - Полная виртуализация. Базовая коммерческая редакция: Proxmox-freeNAS-Zentyal-pfSense</title>
<meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"/>
<meta name="mavenGroupId" content="www.mdl.ru"/>
<meta name="mavenArtifactId" content="VirtualizationComplete"/>
<meta name="mavenVersionId" content="1.0.0"/>
<link rel="home" href="index.html" title="Полная виртуализация. Базовая коммерческая редакция: Proxmox-freeNAS-Zentyal-pfSense"/>
<link rel="up" href="index.html" title="Полная виртуализация. Базовая коммерческая редакция: Proxmox-freeNAS-Zentyal-pfSense"/>
<link rel="prev" href="index.html" title="Вводные материалы"/>
<link rel="next" href="Ch02.html" title="Книга 2. pfSense"/>
<meta name="git-sha" content=""/>
<meta name="buildTime" content=""/>
<script type="text/javascript">
            //The id for tree cookie
            var treeCookieId = "virtualization-complete";
            var language = "en";
            var w = new Object();
            //Localization
            txt_filesfound = 'Results';
            txt_enter_at_least_1_char = "You must enter at least one character.";
            txt_browser_not_supported = "Please enable JavaScript.";
            txt_please_wait = "Please wait. Search in progress...";
            txt_results_for = "Results for: ";
</script>
<style type="text/css">
            input {
            margin-bottom: 5px;
            margin-top: 2px;
            }

            .folder {
            display: block;
            height: 22px;
            padding-left: 20px;
            background: transparent url(../common/jquery/treeview/images/folder.gif) 0 0px no-repeat;
            }
</style>
<link rel="shortcut icon" href="../MdlLogo.gif" type="image/gif"/>
<link rel="stylesheet" type="text/css" href="../common/css/positioning.css"/>
<link rel="stylesheet" type="text/css" href="../common/css/custom.css"/>
<link rel="canonical" href="http://onreader.mdl.ru/VirtualizationComplete/content/index.html"/>
<!--[if IE]>
	<link rel="stylesheet" type="text/css" href="../common/css/ie.css"/>
<![endif]-->
<link rel="stylesheet" type="text/css" href="../common/jquery/theme-redmond/jquery-ui-1.8.2.custom.css"/>
<link rel="stylesheet" type="text/css" href="../common/jquery/treeview/jquery.treeview.css"/>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.11.0.min.js"><!----></script>
<script type="text/javascript" src="../common/jquery/jquery-ui-1.8.2.custom.min.js"><!----></script>
<script type="text/javascript" src="../common/jquery/jquery.cookie.js"><!----></script>
<script type="text/javascript" src="../common/jquery/treeview/jquery.treeview.min.js"><!----></script>
<link rel="stylesheet" type="text/css" href="http://cdn.jsdelivr.net/qtip2/2.2.0/jquery.qtip.min.css"/>
<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/qtip2/2.2.0/jquery.qtip.min.js">
<!--jQuery plugin for glossary popups. --></script><script type="text/javascript" src="search/htmlFileList.js"><!----></script>
<script type="text/javascript" src="search/htmlFileInfoList.js"><!----></script>
<script type="text/javascript" src="search/nwSearchFnt.js"><!----></script>
<script type="text/javascript" src="search/stemmers/en_stemmer.js">
<!--//make this scalable to other languages as well.--></script>
<script type="text/javascript" src="search/index-1.js"><!----></script>
<script type="text/javascript" src="search/index-2.js"><!----></script>
<script type="text/javascript" src="search/index-3.js"><!----></script>
<script type="text/javascript">
	    var _gaq = _gaq || [];
	    _gaq.push(['_setAccount', 'UA-17511903-1']);
	    
	    _gaq.push(['_setDomainName', '.openstack.org']);	        
</script>
<script type="text/javascript" src="../common/ga.js"><!----></script>
<script language="javascript" src="/js/common.js"></script>
<link rel="stylesheet" href="../common/css/googlecode.css">
<script src="../common/highlight.pack.js"></script>
</head>
<body>
<!----><script type="text/javascript"><!--
hljs.initHighlightingOnLoad();
HeaderName = 'Книга 1. Proxmox VE';
PrevRef = 'index.html';
UpRef = 'index.html';
NextRef = 'Ch02.html';//-->
</script>
<!----><script type="text/javascript" src="HeaderAndToolbar.js">
</script><script type="text/javascript"><!--
document.write(HeaderAndToolbar); //-->
</script>
<div id="content">
 <div class="part">
  <div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title">
   Книга 1. Proxmox VE</h1>
  </div></div></div>

  <div class="toc"><p><strong>Содержание</strong></p>
   <dl>
   <dt><span class="chapter"><a href="Ch01.html">Книга 1. Proxmox VE</a></span></dt>
   <dd><dl>
    <dt><span class="section"><a href="Ch01.html#0101">1.1 Введение в Proxmox</a></span></dt>
    <dt><span class="section"><a href="Ch01.html#0102">1.2 Установка Proxmox</a></span></dt>
    <dt><span class="section"><a href="Ch01.html#0103">1.3 Первичная регистрация</a></span></dt>
    <dt><span class="section"><a href="Ch01.html#0104">1.4 Сетевые адаптеры</a></span></dt>
    <dt><span class="section"><a href="Ch01.html#0105">1.5 Администрирование хранилища LVM</a></span></dt>
    <dt><span class="section"><a href="Ch01.html#0106">1.6 Настройка хранилища LVM</a></span></dt>
    <dt><span class="section"><a href="Ch01.html#0107">1.7 Настройка хранилища NFS</a></span></dt>
    <dt><span class="section"><a href="Ch01.html#0108">1.8 Настройка хранилища iSCSI</a></span></dt>
    <dt><span class="section"><a href="Ch01.html#0109">1.9 Создание настроек ВМ</a></span></dt>
    <dt><span class="section"><a href="Ch01.html#0110">1.10 Резервное копирование и восстановление ВМ</a></span></dt>
    <dt><span class="section"><a href="Ch01.html#0111">1.11 Аппаратные средства ВМ</a></span></dt>
    <dt><span class="section"><a href="Ch01.html#0112">1.12 Добавление прокидываемых ВМ</a></span></dt>
    <dt><span class="section"><a href="Ch01.html#0113">1.13 Сложности Proxmox</a></span></dt>
    <dt><span class="section"><a href="Ch01.html#0114">1.14 Обновление Proxmox</a></span></dt>
   </dl></dd>
   </dl>
  </div>
  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0101"> </a>1.1 Введение в Proxmox</h3>
   </div></div></div>
   <p>Обладая активным сообществом и твёрдым как скала дистрибутив Proxmox сияет! Вы можете загрузить его в CD/DVD ISO формате с веб- сайта Proxmox
   здесь: <a class="link" href="http://www.proxmox.com/en/downloads" target="_top">Proxmox VE</a>. Для целей данной книги я использую Proxmox VE 3.4.
   {<span class="emphasis"><em>Прим. пер.: На момент перевода доступна версия Proxmox VE v.4.1, начиная с Proxmox VE v.4x LXC заменил 
   OpenVZ.</em></span>} После загрузки образа, прожгите его на диск {Прим. пер.: или, если не хотите следовать приводимой инструкции, 
   примените одно из средств  для переноса ISO на флеш-носитель с сохранением возможности загрузки, например:
   <a class="link" href="http://unetbootin.github.io/" target="_top">http://unetbootin.github.io/</a>,
   <a class="link" href="http://www.ubuntu.com/download/desktop/create-a-usb-stick-on-windows" target="_top">http://www.ubuntu.com/download/desktop/create-a-usb-stick-on-windows</a>},
   вставьте загрузочный образ и следуйте простой последовательности установки. Для тех, кто не знаком с Proxmox: это полная платформа 
   управления виртуализацией с открытым кодом. Она предлагает функциональность корпоративного уровня, такую как высокая доступность (HA, 
   High Availability), кластеризацию, миграцию в реальном времени, управление через веб- интерфейс, а также возможности транзита (пробрасывания, 
   pass-through) аппаратных средств. Она также способна работать на новейшей файловой системе ZFS и допускает виртуализацию как с помощью KVM 
   так и контейнерами OpenVZ {<span class="emphasis"><em>Прим. пер.: начиная с Proxmox VE v.4x LXC заменил OpenVZ</em></span>}.</p>
   <p>При достижениях в современных аппаратных средствах насамом деле не существует никакой причины чтобы НЕ виртуализировать. Это делает простыми 
   управление и техническое обслуживание при предоставлении большей совместимости ссужающей более длинные жизненные циклы программного и аппаратного 
   обеспечения.</p>
   <p>Если вы зависите от 32-битной Windows XP для некого слишком дорогого пакета программного обеспечения, вам больше не придётся выполнять 
   обновления после аппаратного сбоя на физической машине. Просто виртуализируйте машину из резервной копии!</p>
     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
	   <table border="0" summary="Замечание"><tr><td rowspan="2" align="center" valign="top" width="25"><a id="DockerBooleanFlags"> </a>
	   <img alt="[Замечание]" src="../common/images/admon/note.png"/></td><th align="left">Замечание</th></tr><tr><td align="left" valign="top">
	   <p>Proxmox является мощной платформой его набор свойств не может быть полностью охвачен данной книгой. Данное руководство разработано 
	   как пошаговое чтобы помочь вам быстро встать на ноги и пойти. Я настоятельно рекомендую использовать богатые сетевые ресурсы для более 
	   глубокого понимания.</p></td></tr></table>
     </div>
  </div>
  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0102"> </a>1.2 Установка Proxmox</h3>
   </div></div></div>
  <p>Вставьте диск Proxmox и загрузите вашу машину. Вас поприветствует следующее окно.</p>
  <p>Для продолжения: нажмите <span class="term"><strong class="userinput">Enter</strong></span></p>
	<div class="figure"><a id="Fig0101"> </a>
	 <p class="title"><strong> </strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0101.jpg" width="274" height="173"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
	 <p class="title"><strong>EULA</strong></p>
   <p>Следующий экран (отображённый ниже) содержит лицензионное соглашение конечного пользователя (EULA, END USER LICENSE AGREEMENT). Я знаю, 
   вы аккуратно прочтёте эту форму от начала до конца! Когда завершите чтение:</p>
   <p>Для продолжения: нажмите <span class="term"><strong class="userinput"> I Agree</strong></span> (я согласен).</p>
	<div class="figure"><a id="Fig0102"> </a>
	 <p class="title"><strong> </strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0102.jpg" width="516" height="574"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p class="title"><strong>Настройка жёсткого диска</strong></p>
   <p>Данный шаг предполагает простую установку с одним диском и никаких RAID. Моё личное предпочтение здесь состоит в наличии только одного 
   диска подключённого к материнской плате для новой установки. Просто отключите все диски за исключением единственного используемого для данной 
   ОС. Это позволит обойти любые возможные MBR проблемы даже если вам нужно удалить диски из- за отказа. Легко запутаться если у вас имеется в 
   какой-то машине много установленных жёстких дисков. По этой причине мне нравится включать карту идентификаторов жёстких дисков. Она может быть 
   простой наподобие наклеек или магических идентификационных маркеров на каждом диске.</p>
     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
	   <table border="0" summary="Замечание"><tr><td rowspan="2" align="center" valign="top" width="25"><a id="DockerBooleanFlags"> </a>
	   <img alt="[Замечание]" src="../common/images/admon/note.png"/></td><th align="left">Замечание</th></tr><tr><td align="left" valign="top">
	   <p>Разработчики Proxmox давно рекомендуют устанавливать исключительно на единственный диск с выделенным LVM разделом и под его управлением.
	   До недавнего времени RAID не поддерживался. Моё личное мнение таково, что RAID действительно не имеет значения. При правильном 
	   использовании система всегда будет снята с обслуживания до наступления отказа диска. <span class="term"><strong 
	   class="userinput">ВСЕГДА</strong></span> существуют предупредительные знаки! С инженерной точки зрения массивы с чётностью наподобие 
	   <span class="term"><strong class="userinput">RAID (1, 5, 6 или 10)</strong></span> привносят дополнительные рабочие циклы и тепловыделение,
	   тем самым сокращая срок службы мотора. Чередующийся массив наподобие <span class="term"><strong class="userinput">RAID-0</strong></span> 
	   уменьшает рабочие циклы и тепловыделение, тем самым увеличивая пробег двигателя! В качестве бонуса они к тому же увеличивают пропускную 
	   способность! Это единственный RAID, который я применяю по указанным причинам!</p></td></tr></table>
     </div>
   <p>Назад к нашей установке! Кликнув по кнопке параметров ниже вы отметите, что Proxmox теперь допускает ZFS raid настройки! Как отмечено выше, 
   я не использую этого, но это возможно, если вы пожелаете. Если вы следуете моим инструкциям, как вам и следует поступать, мы выполним установку по
   умолчанию для нашего первичного целевого диска (<span class="term"><code>/dev/sda</code></span>), таким образом закроем диалог параметров если 
   вы его открыли.</p>
   <p>Для продолжения: нажмите <span class="term"><strong class="userinput">Next</strong></span></p>
	<div class="figure"><a id="Fig0103"> </a>
	 <p class="title"><strong> </strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0103.jpg" width="519" height="571"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p class="title"><strong>Выберите местоположение и время</strong></p>
   <p>Далее выустановите ваше местоположение по умолчанию и зону времени.</p>
   <p>Для продолжения: нажмите <span class="term"><strong class="userinput">Next</strong></span></p>
	<div class="figure"><a id="Fig0104"> </a>
	 <p class="title"><strong> </strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0104.jpg" width="517" height="566"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p class="title"><strong>Пароль и адрес эл.почты root</strong></p>
   <p>Теперь вы установите парлоь вашего root и почтовый адрес. Убедитесь в применении сильного пароля root!</p>
   <p>Для продолжения: нажмите <span class="term"><strong class="userinput">Next</strong></span></p>
	<div class="figure"><a id="Fig0105"> </a>
	 <p class="title"><strong> </strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0105.jpg" width="520" height="572"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p class="title"><strong>Настройка сетевой среды</strong></p>
   <p>Далее вы настроите свою сетевую среду. Ваши установки должны выглядеть как- то так (где x может быть заменен любым числом из диапазона 
   от 0до 255):</p>
   	   <pre class="screen">
FQDN: proxmox1.yourdomain.com
IP Address: 192.168.x.2
Netmask: 255.255.255.0
Gateway: 192.168.x.254
DNS: 192.168.x.254
	   </pre>
     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
	   <table border="0" summary="Замечание"><tr><td rowspan="2" align="center" valign="top" width="25"><a id="DockerBooleanFlags"> </a>
	   <img alt="[Замечание]" src="../common/images/admon/note.png"/></td><th align="left">Замечание</th></tr><tr><td align="left" valign="top">
	   <p>Мы выбрали <span class="term"><code>192.168.x.254</code></span> и для шлюза, и для DNS, поскольку они расположены за пределами 
	   диапазона адресов DHCP по умолчанию (<span class="term"><code>192.168.x.100-192.168.x.200</code></span>) в большинстве маршрутизаторов.
	   Для особенных правил при частной адресации IP найдите в интернете руководство RFC 1918. Я настоятельно рекомендую использовать pfSense для 
	   управления платформой сетевого терминала/ маршрутизации! Я применяю её на протяжении 7 лет виртуализации без происшествий! Она будет 
	   обрабатывать все DHCP, DNS, NAT, VPN, а также определение вторжений. Вы можете загрузить её здесь: 
	   <a class="link" href="https://www.pfsense.org/download/" target="_top">маршрутизатор pfSense</a>
	   </p></td></tr></table>
     </div>
   <p>Для продолжения: нажмите <span class="term"><strong class="userinput">Next</strong></span></p>
	<div class="figure"><a id="Fig0106"> </a>
	 <p class="title"><strong> </strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0106.jpg" width="517" height="570"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p class="title"><strong>Установка успешна</strong></p>
   <p>Для продолжения: нажмите <span class="term"><strong class="userinput">Reboot</strong></span></p>
	<div class="figure"><a id="Fig0107"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0107.jpg" width="517" height="569"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
	   <table border="0" summary="Замечание"><tr><td rowspan="2" align="center" valign="top" width="25"><a id="DockerBooleanFlags"> </a>
	   <img alt="[Замечание]" src="../common/images/admon/note.png"/></td><th align="left">Заметьте, пожалуйста:</th></tr><tr><td align="left" valign="top">
	   <p>В процессе перезагрузки Proxmox не пропустите ваш адрес для регистрации через веб- интерфейс. Он должен соответствовать набору адреса 
	   из предыдущего экрана настроек сетевой среды.</p>
	   <p>Пример: <span class="term"><code>https://192.168.10.2:8006</code></span></p></td></tr></table>
     </div>
	<div class="figure"><a id="Fig0108"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0108.jpg" width="516" height="204"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>В данной точке вам следует зарегистрироваться в качестве <span class="emphasis"><em>root</em></span> используя введённый вами в процессе 
   установки <span class="emphasis"><em>password</em></span> и выполнить останов. Команда показана ниже. Просто введите слово 
   <span class="term"><code>poweroff</code></span> с последующим нажатием клавиши <span class="term"><strong class="userinput">Enter</strong></span>.</p>
   	   <pre class="screen">
# poweroff
	   </pre>
		 <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
			<table border="0" summary="Совет"><tr><td rowspan="2" align="center" valign="top" width="25">
			<img alt="[Совет]" src="../common/images/admon/tip.png"/></td><th align="left">Настоятельно рекомендуется:</th></tr><tr><td align="left" valign="top">
			<p>После выключения машины вы установите некие дополнительные сетевые адаптеры жёсткие диски. Я рекомендую помечать сетевые адаптеры 
			аппаратными адресами MAC. Если вы незнакомы с аппаратными адресами MAC, они обычно выглядят как-то наподобие 
			<span class="term"><code>92:26:b9:c2:42:15</code></span> и должны ясно идентифицировать устройство. Вам потребуется возможность 
			идентифицировать каждый сетевой порт извне с применением его MAC. Что касается меня, я записываю последние 4 цифры моих MAC 
			на каждой планке адаптера магическим маркером для лёгкой идентификации.</p></td></tr></table>
		  </div>
   <p>Я обнаружил, что некоторые USB сетевые адаптеры действительно работают хорошо и уже помечены идентификатором и серийным номером. Я применяю 
   их для соединений с низкой пропускной способностью, например для маршрутизатора pfSense.</p>
   <p>По завершению запустите вашу машину для последующих шагов вашей установки.</p>
  </div>
  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0103"> </a>1.3 Первичная регистрация</h3>
   </div></div></div>
   <p>Теперь, когда вы выполнили установку, самое время зарегистрироваться. Откройте свой любимый веб- браузер (я пользуюсь Mozilla Firefox),
   а затем введите выбранный при установке ip адрес.</p>
     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
	   <table border="0" summary="Замечание"><tr><td rowspan="2" align="center" valign="top" width="25"><a id="DockerBooleanFlags"> </a>
	   <img alt="[Замечание]" src="../common/images/admon/note.png"/></td><th align="left">Заметьте, пожалуйста:</th></tr><tr><td align="left" valign="top">
	   <p>По умолчанию Proxmox применяет безопасный порт <span class="term"><code>8006</code></span></p></td></tr></table>
     </div>
   <p>Ваш ввод должен выглядеть примерно так:</p>
   	   <pre class="screen">
https://192.168.10.2:8006
	   </pre>
   <p>Затем вы увидите предупреждение безопасного соединения как на приводимом ниже рисунке. Нажмите 
   <span class="term"><strong class="userinput">I Understand Risks</strong></span> (я осознаю риски)</p>
	<div class="figure"><a id="Fig0109"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0109.jpg" width="479" height="259"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
	<p>{<span class="emphasis"><em>Прим. пер.: в Firefox 44.0.2 окно предупреждения выглядите насколько иначе:
	<div class="figure"><a id="FigT0101"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/FigT0101.jpg" width="362" height="300"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
	тем не менее, нажмите на кнопку Дополнительно с прежним результатом.</em></span>}</p>
   <p>Далее: Нажмите <span class="term"><strong class="userinput">Add Exception</strong></span> (добавить исключение), как изображено ниже</p>
	<div class="figure"><a id="Fig0110"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0110.jpg" width="477" height="341"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Затем: Нажмите <span class="term"><strong class="userinput">Confirm Security Exception</strong></span> (подтвердите исключение безопасности), 
   как изображено ниже</p>
	<div class="figure"><a id="Fig0111"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0111.jpg" width="381" height="380"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Теперь зарегистрируйтесь в качестве пользователя <span class="term"><strong class="userinput">root</strong></span> с установленным в процессе 
   установки паролем</p>
	<div class="figure"><a id="Fig0112"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0112.jpg" width="303" height="141"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p><span class="term"><strong class="userinput">Proxmox VE</strong></span> является редакцией сообщества, но вы можете выбрать учетную запись 
   подписки, которая предоставляет право на полную подписку {<span class="emphasis"><em>Прим. пер.: обсудить условия подписки на 
   консультации наших специалистов, руководимых профильными лабораториями МФТИ вы можете <a href="javascript:tocall()" 
   onmouseover="this.href=mail">здесь</a></em></span>}. В этом нет необходимости, однако вы видите напоминание о подписке (отображённое ниже) 
   при каждом входе в систему. Лично я нахожу Proxmox отличным программным обеспечением и действительно не прочь видеть всплывающее 
   напоминание! В конце, концов! ПО Proxmox бесплатное!</p>
	<div class="figure"><a id="Fig0113"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0113.jpg" width="437" height="89"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Теперь вы увидите веб- интерфейс управления (показанный ниже). Это то место, где вы будете создавать и настраивать свои виртуальные 
   машины.</p>
	<div class="figure"><a id="Fig0114"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0114.jpg" width="516" height="687"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
  </div>
  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0104"> </a>1.4 Сетевые адаптеры</h3>
   </div></div></div>
   <p>Теперь вам нужно настроить ваши сетевые адаптеры, поскольку они могут использоваться всеми создаваемыми вами 
   <span class="term"><strong class="userinput">ВМ</strong></span> (виртуальными машинами). Отметим, что закладка сетевой среды не 
   отображается при просмотре по умолчанию (<span class="emphasis"><em>datacenter view</em></span> - просмотр центра данных). Вы 
   должны находится в режиме просмотра узлов <span class="emphasis"><em>node view</em></span> чтобы увидеть закладку сетевой среды.
   В случае приводимой ниже картинки <span class="emphasis"><em>узел</em></span> имеет имя 
   <span class="term"><strong class="userinput"><code>proxmox5</code></strong></span>.</p>
   <p>Кликните по <span class="term"><strong class="userinput">узлу</strong></span> (изображённому ниже)</p>
	<div class="figure"><a id="Fig0115"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0115.jpg" width="447" height="137"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Кликните по <span class="term"><strong class="userinput">Network tab</strong></span> (закладке сетевых средств, изображённой ниже)</p>
	<div class="figure"><a id="Fig0116"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0116.jpg" width="435" height="143"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Кликните по <span class="term"><strong class="userinput">Create &gt;&gt; Linux Bridge</strong></span> (изображённой ниже)</p>
	<div class="figure"><a id="Fig0117"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0117.jpg" width="429" height="203"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Теперь вы видите <span class="emphasis"><em>Linux Bridge Dialog</em></span> (изображённый ниже). Для каждого сетевого адаптера вы 
   создадите свой мост. Вы можете видеть (для данного руководства) я заполнил форму с применением промышденного стандарта именования и 
   сохранив соотношение 1:1 между портами <span class="term"><strong class="userinput"><code>eth(x)</code></strong></span> и 
   <span class="term"><strong class="userinput"><code>vmbr(x)</code></strong></span>. Для использующего первый раз я бы предложил это 
   правило, но вы легко можете пометить вместо этого <span class="term"><code>vmbr1 &gt;&gt; eth2</code></span>. В нашем случае будет 
   присутствовать только 1 шлюз (<span class="term"><strong class="userinput">Gateway</strong></span>) интернета по умолчанию, который 
   предварительно настраивается в процессе установки с использованием <span class="term"><strong class="userinput"><code>vmbr0</code></strong></span>,
   поэтому оставьте это поле не заполненным.</p>
     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
	   <table border="0" summary="Замечание"><tr><td rowspan="2" align="center" valign="top" width="25"><a id="DockerBooleanFlags"> </a>
	   <img alt="[Замечание]" src="../common/images/admon/note.png"/></td><th align="left">Замечание:</th></tr><tr><td align="left" valign="top">
	   <p>Для поля <span class="term"><strong class="userinput"><code>IP address</code></strong></span> проверьте, что ваша подсеть НЕ 
	   используется в вашей системе (например, <span class="term"><code>10.10.x.x</code></span>). Также что вы используете надлежащую 
	   <span class="term"><strong class="userinput"><code>Subnet mask</code></strong></span> для выбранного вами диапазона IP адресов.
	   Если вы не знакомы с сетевой адресацией, наберите в Google CIDR {<span class="emphasis"><em>Прим. пер.: например, 
	   <a class="link" href="https://ru.wikipedia.org/wiki/Бесклассовая_адресация" target="_top">ru.wikipedia.org/wiki/Бесклассовая_адресация</a></em></span>}.
	   Сложности инжениринга сетевой среды выходит за рамки данного пошагового руководства, однако существует сокровищница знаний, которую
	   можно найти в Интернете.</p></td></tr></table>
     </div>
   <p>Кликните <span class="term"><strong class="userinput">Create</strong></span> по окончанию.</p>
	<div class="figure"><a id="Fig0118"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0118.jpg" width="445" height="147"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
	   <table border="0" summary="Замечание"><tr><td rowspan="2" align="center" valign="top" width="25"><a id="DockerBooleanFlags"> </a>
	   <img alt="[Замечание]" src="../common/images/admon/note.png"/></td><th align="left">Замечание:</th></tr><tr><td align="left" valign="top">
	   <p>Повторите приведённые выше шаги для каждого предполагаемого к использованию в вашем новом сервере Proxmox адаптера. Например:
	   <span class="term"><code>vmbr2 &gt;&gt; eth2 @ 10.10.30.2/255.255.255.0</code></span>).</p></td></tr></table>
     </div>
   <p>Изменения не вступят в действие пока система не будет перезагружена.</p>
   <p><span class="term"><strong class="userinput">Перезагрузитесь сейчас</strong></span> применив кнопку в 
   <span class="emphasis"><em>верхнем правом углу</em></span> просмотра узлов (вы должны уже быть в этом просмотре).</p>
	<div class="figure"><a id="Fig0119"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0119.jpg" width="361" height="110"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Когда система завершит перезагрузку, она должна автоматически обновить экран. Вы можете <span class="term"><strong class="userinput">подтвердить</strong></span>, 
   что ваши виртуальные интерфейсы готовы, если в колонке <span class="emphasis"><em>Active</em></span> возникло значение 
   <span class="term"><strong class="userinput"><code>yes</code></strong></span> (изображено ниже). И снова, повторите этот процесс для всех 
   предполагаемых к применению сетевых адаптеров. Здесь вы можете увидеть, что у меня есть 3 физических адаптера, но настроены и готовы только 2.</p>
	<div class="figure"><a id="Fig0120"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0120.jpg" width="494" height="172"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
  </div>
  
  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0105"> </a>1.5 Администрирование хранилища LVM</h3>
   </div></div></div>
   <p>Перед тем как вы сможете добавить хранилище <span class="term"><strong class="userinput"><code>LVM</code></strong></span>, вам нужно 
   установить <span class="term"><strong class="userinput"><code>PuTTY</code></strong></span>. 
   <span class="term"><strong class="userinput"><code>PuTTY</code></strong></span> это великолепная консоль, которая делает возможным  
   <span class="term"><strong class="userinput"><code>SSH</code></strong></span> (безопасной оболочки) доступ к другим компьютерам. 
   Она может быть загружена здесь: <a class="link" href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html" 
   target="_top">PuTTY console</a>.</p>
   <p>После установки откройте его, проверьте соединение SSH, введите ip адрес вашего сервера Proxmox, затем кликните Open.</p>
	<div class="figure"><a id="Fig0121"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0121.jpg" width="389" height="325"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Кликните <span class="term"><strong class="userinput"><code>Yes</code></strong></span> на предупреждение безопасности PuTTY (изображённое
   ниже)</p>
	<div class="figure"><a id="Fig0122"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0122.jpg" width="306" height="145"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Зарегистрируйтесь в качестве пользователя <span class="term"><strong class="userinput"><code>root</code></strong></span> с назначенным 
   в процессе установки Proxmox паролем.</p>
   <p>Теперь введите следующую команду:</p>
   	   <pre class="screen">
# cat /proc/partitions
	   </pre>
	<div class="figure"><a id="Fig0123"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0123.jpg" width="476" height="151"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Эта команда создаст список устройств жесткого диска как изображено ниже. Мы ищем новые устройства, которые не наблюдаются в службе.
   <span class="term"><strong class="userinput">ЕДИНСТВЕННОЕ</strong></span> доступное устройство, как мы видим, это 
   <span class="term"><strong class="userinput"><code>dev/sdb</code></strong></span>, поскольку оно совсем не содержит разделов. Теперь 
   у нас достаточно информации для настройки на этом диске <span class="emphasis"><em>логического устройства</em></span>.</p>
	<div class="figure"><a id="Fig0124"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0124.jpg" width="474" height="160"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Теперь, когда вы знаете какой диск использовать, вы можете создать <span class="emphasis"><em>физический том</em></span> при 
   помощи следующей команды:</p>
   	   <pre class="screen">
# pvcreate /dev/sdb
	   </pre>
	<div class="figure"><a id="Fig0125"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0125.jpg" width="473" height="164"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Теперь вы увидите подтверждение создания тома как изображено ниже</p>
	<div class="figure"><a id="Fig0126"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0126.jpg" width="472" height="172"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Теперь, когда <span class="emphasis"><em>физический том</em></span> существует, вы можете создать <span class="emphasis"><em>группу томов</em></span>
   (volune group) с именем <span class="term"><code>lvstorage</code></span> (или каким- то другим именем по вашему выбору).</p>
   <p>Чтобы создать <span class="emphasis"><em>группу томов</em></span> выполните следующую команду:</p>
   	   <pre class="screen">
# vgcreate lvstorage /dev/sdb
	   </pre>
	<div class="figure"><a id="Fig0127"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0127.jpg" width="472" height="173"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Теперь вы видите подтверждение создания <span class="emphasis"><em>группы томов</em></span> изображённое ниже.</p>
	<div class="figure"><a id="Fig0128"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0128.jpg" width="470" height="161"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Теперь вы завершили работу в консоли команд и можете закрыть программу <span class="term"><strong class="userinput"><code>PuTTY</code></strong></span>.</p>
   <p>Я настоятельно рекомендую изучить Linux <span class="term"><strong class="userinput"><code>LVM</code></strong></span> настолько досконально,
   насколько это возможно {<span class="emphasis"><em>Прим. пер.: отсылаем к &quot;<a class="link" href="http://xgu.ru/wiki/LVM" target="_top">Повести 
   о Linux и LVM</a>&quot;</em></span>}. Моё личное предпочтение состоит в применении <span class="term"><strong class="userinput"><code>PuTTY</code></strong></span> 
   для всего! Он загружается с применением <span class="term"><strong class="userinput"><code>идентификации UUID</code></strong></span>, что делает его 
   пуленепробиваемым загрузчиком и позволяет удалять устройства для переноса на другие машины. Вы также можете  создавать 
   <span class="emphasis"><em>striping</em></span> и <span class="emphasis"><em>mirrored</em></span> (чередующиеся и зеркалированные) тома, а 
   также поддерживает снимки, изменение размеров, перемещение и т.п. ... Он имеет малый вес и исключительно отвечает нашей модели максимального 
   упрощения.</p>
   <p class="title"><strong>Про LVM</strong></p>
   <p>Хранилище LVM описывается тремя компонентами, а именно: физическим томами (PV, physical volume), группами томов (VG, volume group) и логическими 
   томами (LV, logical volume) {<span class="emphasis"><em>Прим. пер.: строго говоря, ещё и логическими экстентами (LE, logical extent), см.  
   &quot;<a class="link" href="http://gu.ru/wiki/LVM#Терминология" target="_top">Терминология LVM</a>&quot;, а также физическими экстентами 
   (PE, physical extent), см. &quot;<a class="link" href="ttps://ru.wikipedia.org/wiki/LVM#Термины" target="_top">Термины LVM</a>&quot;</em></span>}. 
   Группа создаётся из 1 или более физических томов. PV (физический том) ничего более, как жёсткий диск. Первичной компонентой хранения 
   является логический том. Группа томов может быть нарезана на множество логических томов. Например: У вас есть 3x500ГБ физических диска, 
   формирующих вашу VG (группу томов). Соответственно, существуют <span class="term"><code>/dev/sda</code></span>, 
   <span class="term"><code>/dev/sdb</code></span> и <span class="term"><code>/dev/sdс</code></span>. Общая ёмкость этой группы 
   составит 1.5ТБ и вы можете назвать её <span class="term"><code>vg_500gbint</code></span>. Мне нравится использовать имена, которые несут 
   информацию о размерах используемых мной устройств и того являются ли они внутренними или внешними. Затем вы можете создать 
   2 x 750ГБ LV (логических тома) или 15 x 100ГБ LV из вашей 1.5ТБ VG.</p>
   <p>Вы можете захотеть дать вашим LV имена наподобие <span class="term"><code>lv1_vg500gbint</code></span>, что будет отображать, что это 
   первый логический том, ассоциированный с групой томов с именем <span class="term"><code>vg_500gbint</code></span>.</p>
  </div>
  
  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0106"> </a>1.6 Настройка хранилища LVM</h3>
   </div></div></div>
   <p>Теперь, когда вы добавили группу логических томов в командной строке, наступило время настроить так, как это применяется в Proxmox. 
   Следует отметить один момент, а именно (в этом руководстве) хранилища LVM с веб- интерфейсом будут применяться только для образов ВМ. 
   Это специализированные области хранения, в которых ваши виртуальные машины будут хранить свои назначенные жесткие диски.</p>
   <p>Чтобы начать, убедитесь что вы находитесь в режиме просмотра центра данных, затем кликните по закладке хранилищ (Storage, изображённой 
   ниже). Затем кликните <span class="term"><strong class="userinput">Add &gt;&gt; LVM</strong></span>.</p>
	<div class="figure"><a id="Fig0129"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0129.jpg" width="445" height="258"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Сейчас вы должны увидеть блок диалога LVM (изображённый ниже). Теперь может быть выбрана созданная вами с применением 
   <span class="term"><strong class="userinput"><code>PuTTY</code></strong></span> группа 
   <span class="term"><strong class="userinput"><code>lvstorage</code></strong></span>. Наберите уникальное имя для поля 
   <span class="term"><strong class="userinput"><code>ID</code></strong></span>.</p>
   <p>По завершению кликните <span class="term"><strong class="userinput">Add</strong></span></p>
     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
	   <table border="0" summary="Замечание"><tr><td rowspan="2" align="center" valign="top" width="25"><a id="DockerBooleanFlags"> </a>
	   <img alt="[Замечание]" src="../common/images/admon/note.png"/></td><th align="left">Замечание</th></tr><tr><td align="left" valign="top">
	   <p>Я часто выбираю имя, которое отображает тип хранилища, например <span class="term"><strong class="userinput"><code>LV_vg80gbint</code></strong></span>.</p></td></tr></table>
     </div>
	<div class="figure"><a id="Fig0130"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0130.jpg" width="448" height="128"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Теперь вы должны увидеть новое хранилище LVM в просмотре дерева (tree view, изображённое ниже). Кликните на закладку Summary отображающую 
   доступные размеры вашего нового хранилища (изображённые ниже).</p>
	<div class="figure"><a id="Fig0131"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0131.jpg" width="372" height="245"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
  </div>
  
  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0107"> </a>1.7 Настройка хранилища NFS</h3>
   </div></div></div>
   <p>NFS возможно является наиболее многообразным из всех типов систем хранения. которые вы будете применять. Это система хранения на 
   основе сетевой среды, так что вам придётся настраивать NAS в вашей локальной подсети для её применения. NFS может быть использована 
   для хранения в Proxmox образов, резервных копий, ISO и контейнеров. Я тщательно протестировал все типы хранения в Proxmox на протяжении 
   многих лет. Кук уже упоминалось ранее, моим выбором хранилища для локальных образов является основанное на LVM! Ну, а моё предпочтение 
   для хранения с сетевой поддержкой является NFS! Она предлагает соперничающую с iSCSI производительность без каких- либо сложностей.</p>
   <p>В данном разделе я продемонстрирую настройку существующего совместного ресурса NFS, который будет применяться для архивов резервных 
   копий ВМ. При промышленном применении вы вероятно захотите (по крайней мере) дополнительный совместный ресурс для файлов ISO CD/DVD. 
   Резервные копии и ISO являются тем, в чём я как правило нуждаюсь!</p>
   <p>Чтобы начать, убедитесь что вы находитесь в просмотре центра данных, затем кликните на закладку Storage (изображённую ниже).</p>
   <p>Затем кликните <span class="term"><strong class="userinput">Add &gt;&gt; NFS</strong></span>.</p>
	<div class="figure"><a id="Fig0132"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0132.jpg" width="442" height="213"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Теперь вы должны увидеть блок диалога NFS (изображённый ниже). Наберите IP адрес вашей системы хранения NAS. Наберите уникальное имя в 
   поле <span class="term"><strong class="userinput"><code>ID</code></strong></span> (изображённом ниже). Выберите соответствующий NFS Export из 
   ниспадающего списка. Также вы можете выбрать сколько архивов резервных копий допускается на каждую ВМ.</p>
   <p>По завершению кликните <span class="term"><strong class="userinput">Add</strong></span></p>
     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
	   <table border="0" summary="Замечание"><tr><td rowspan="2" align="center" valign="top" width="25"><a id="DockerBooleanFlags"> </a>
	   <img alt="[Замечание]" src="../common/images/admon/note.png"/></td><th align="left">Замечание</th></tr><tr><td align="left" valign="top">
	   <p>Я часто выбираю имя, которое отображает тип хранилища, например <span class="term"><strong class="userinput"><code>NFS_NetBackups</code></strong></span>.</p></td></tr></table>
     </div>
	<div class="figure"><a id="Fig0133"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0133.jpg" width="496" height="148"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Вы должны теперь увидеть ваше новое хранилище NFS в просмотре дерева (изображённом ниже).</p>
	<div class="figure"><a id="Fig0134"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0134.jpg" width="483" height="111"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
  </div>
  
  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0108"> </a>1.8 Настройка хранилища iSCSI</h3>
   </div></div></div>
   <p>Третья, и завершающая, опция хранилища для Proxmox, которую мы охватим в этой книге это <span class="term"><strong class="userinput">iSCSI</strong></span>.
   Этот тип хранилища обычно применяется большими предприятиями с сотнями серверов в случаях когда скорость интернета является ограничивающим 
   фактором, а скачки производительности ожидаются динамичными. Поскольку это <span class="emphasis"><em>хранилище обеспечиваемое сетевой 
   средой</em></span>, производительность ВМ страдает в сравнении с установками на выделенном оборудовании. По этой причине я на самом деле 
   не рекомендую использовать его для любых критически важных приложений.</p>
   <p>Хотя оно действительно имеет накладываемые сетевой средой ограничения, оно является очень гибким и при использовании на высококлассном 
   оборудовании может дать очень приемлемую производительность. То место, где iSCSI сияет, это большие тестовые среды в которых вы должны 
   временно сохранять пространство выделяемое на повторяющейся основе. Потому что оно дурачит операционную систему и та полагает, что возможности 
   наличия дополнительных локальных дисков безграничны. Например, оно легко может применяться для настройки зеркалированных массивов на основе 
   LVM, которые соответствуют определённым каталогам монтируемым впоследствии и используемыми для образов ВМ, контейнеров, временных 
   ресурсов и т.п. Чтобы узнать как настраиваются таргеты iSCSI в freeNAS кликните здесь: <a class="link" 
   href="http://onreader.mdl.ru/VirtualizationComplete/content/Ch03.html#031603" target="_top">3.16.3 Совместно используемые таргеты iSCSI</a>.</p>
   <p>Чтобы отметить таргет iSCSI убедитесь что вы в <span class="term"><strong class="userinput">Datacenter &gt;&gt; Storage</strong></span>,
   затем кликните <span class="term"><strong class="userinput">Add &gt;&gt; iSCSI</strong></span> (отображено ниже).</p>
	<div class="figure"><a id="Fig0135"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0135.jpg" width="399" height="276"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Затем вы увидите следующий диалог. Введите информацию <span class="term"><strong class="userinput">ID</strong></span> и 
   <span class="term"><strong class="userinput">Portal</strong></span>, затем выберите нужный 
   <span class="term"><strong class="userinput">Target</strong></span> из ниспадающего спсика (отображённого ниже). Если вы 
   <span class="emphasis"><em>не</em></span> хотите настраивать таргет в качестве <span class="emphasis"><em>диска LVM</em></span>
   для <span class="emphasis"><em>монтирования</em></span>, убедитесь что помечен параметр <span class="term"><strong class="userinput">Use 
   LUN's directly</strong></span>.</p>
	<div class="figure"><a id="Fig0136"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0136.jpg" width="450" height="142"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Для продолжения: кликните кнопку <span class="term"><strong class="userinput">Add</strong></span> (отображено ниже).</p>
	<div class="figure"><a id="Fig0137"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0137.jpg" width="448" height="130"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>После того, как таргет был успешно добавлен, он появится в качестве нового устройства хранения (изображённого ниже).</p>
	<div class="figure"><a id="Fig0138"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0138.jpg" width="489" height="277"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Теперь вы должны быть в состоянии увидеть информацию содержимого, выбрав её их дерева узлов (отображённого ниже).</p>
	<div class="figure"><a id="Fig0139"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0139.jpg" width="418" height="233"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
  </div>
  
  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0109"> </a>1.9 Создание настроек ВМ</h3>
   </div></div></div>
   <p>Теперь после того как Proxmox настроен, вы можете создать вашу первую ВМ (виртуальную машину)! Давайте выполним установку 
   конфигурации маршрутизатора pfSense.</p>
   <p>Для начала кликните <span class="term"><strong class="userinput">Create VM</strong></span> в верхнем правом углу.</p>
	<div class="figure"><a id="Fig0140"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0140.jpg" width="309" height="91"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Теперь назначим <span class="term"><strong class="userinput">ID</strong></span> и 
   <span class="term"><strong class="userinput">Name</strong></span> вашей новой ВМ.</p>
   <p>Для продолжения: нажмите <span class="term"><strong class="userinput">Next</strong></span></p>
	<div class="figure"><a id="Fig0141"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0141.jpg" width="461" height="298"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Далее выберите тип ОС. pfSense основана на BSD, поэтому выберите (other).</p>
   <p>Для продолжения: нажмите <span class="term"><strong class="userinput">Next</strong></span></p>
	<div class="figure"><a id="Fig0142"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0142.jpg" width="459" height="299"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Следующий шаг предполагает, что у вас имеется некий установленный накопитель ISO и вы работаете с последним pfSense-LiveCD. Для данного 
   руководства я применяю версию выпуска 2.2.4. Если у вас нет никакого накопителя ISO вы можете кликнуть локально в просмотре дерева узлов, 
   а затем загрузить ваш образ CD/DVD. В качестве альтернативы вы можете прожечь ISO на диск, затем выбрать Use physical CD/DVD Drive 
   (изображено ниже).{<span class="emphasis"><em>Прим. пер.: <a class="link" href="https://www.pfsense.org/download/" target="_top">Страница 
   загрузок pfSense</a></em></span>, на момент перевода доступна версия 2.2.6}.</p>
   <p>Для продолжения: нажмите <span class="term"><strong class="userinput">Next</strong></span></p>
	<div class="figure"><a id="Fig0143"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0143.jpg" width="461" height="298"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Далее вы настроите параметры жёсткого диска. Для данной установки pfSense примените тип устройства IDE с 8ГБ диском. Вы можете 
   выбрать <span class="term"><code>local</code></span> или <span class="term"><code>lvstorage</code></span>, который вы настроили 
   ранее в этом руководстве.</p>
     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
	   <table border="0" summary="Замечание"><tr><td rowspan="2" align="center" valign="top" width="25"><a id="DockerBooleanFlags"> </a>
	   <img alt="[Замечание]" src="../common/images/admon/note.png"/></td><th align="left">Замечание</th></tr><tr><td align="left" valign="top">
	   <p>После обширного тестирования предпочитаемая мной настройка диска состоит в использовании
	   ВСЕГДА использовать установки IDE Bus, Raw disk Format и Default Cache.</p></td></tr></table>
     </div>
   <p>Когда завершите: нажмите <span class="term"><strong class="userinput">Next</strong></span></p>
	<div class="figure"><a id="Fig0145"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0145.jpg" width="459" height="298"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Теперь выберите сколько ядер ЦПУ использовать для работы. НЕ устанавливайте больше ядер, чем у вас доступно, или ВМ не может загрузить! 
   Для типа ЦПУ я рекомендую <span class="term"><code>KVM</code></span>. В некоторых случаях ваша ВМ может не загружаться. Если это происходит, 
   выберите вместо него <span class="term"><code>QEMU</code></span>.</p>
     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
	   <table border="0" summary="Замечание"><tr><td rowspan="2" align="center" valign="top" width="25"><a id="DockerBooleanFlags"> </a>
	   <img alt="[Замечание]" src="../common/images/admon/note.png"/></td><th align="left">СПЕЦИАЛЬНЫЙ СЛУЧАЙ</th></tr><tr><td align="left" valign="top">
	   <p><span class="term"><strong class="userinput">pfSense на основе BSD является одним из тех случаев, когда вы ДОЛЖНЫ 
	   выбирать тип ЦПУ <span class="term"><code>QEMU</code></span>.</strong></span></p></td></tr></table>
     </div>
     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
	   <table border="0" summary="Замечание"><tr><td rowspan="2" align="center" valign="top" width="25"><a id="DockerBooleanFlags"> </a>
	   <img alt="[Замечание]" src="../common/images/admon/note.png"/></td><th align="left">Замечание</th></tr><tr><td align="left" valign="top">
	   <p>Если ваша ВМ не загружается, она, как правило, могла вернуться к неподходящему типу ЦПУ. Кроме того, вы обычно 
	   выбираете 64 бита вто время как вам было нужно 32 бита.</p></td></tr></table>
     </div>
   <p>Когда завершите: нажмите <span class="term"><strong class="userinput">Next</strong></span></p>
	<div class="figure"><a id="Fig0144"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0144.jpg" width="459" height="299"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Теперь вам нужно настроить оперативную память. Двумя возможными режимами являются <span class="term"><code>fixed</code></span> и 
   <span class="term"><code>auto</code></span>. Я склонен применять <span class="term"><code>auto</code></span>, в основном потому, что 
   она разделяет память и НЕ допускает излишнее выделение. Я советую выполнять pfSense с показанными ниже настройками оперативной памяти.</p>
     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
	   <table border="0" summary="Замечание"><tr><td rowspan="2" align="center" valign="top" width="25"><a id="DockerBooleanFlags"> </a>
	   <img alt="[Замечание]" src="../common/images/admon/note.png"/></td><th align="left">Замечание</th></tr><tr><td align="left" valign="top">
	   <p>Является возможным выделить так много фиксированной памяти, что ОС Proxmox отнимет все ресурсы оперативной 
	   памяти!</p></td></tr></table>
     </div>
   <p>Для продолжения: нажмите <span class="term"><strong class="userinput">Next</strong></span></p>
	<div class="figure"><a id="Fig0146"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0146.jpg" width="460" height="298"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Далее вы настроите сетевой мост. Мы установим LAN адаптер pfSense на <span class="term"><code>vmbr0</code></span>. Это безопасно в 
   маршрутизаторе, поскольку единственный проходящий траффик это интернет, который имеет малую пропускную способность относительно 
   максимальных возможностей сетевых адаптеров. Для модели адаптера выберите Intel E1000. Я настоятельно рекомендую это!</p>
     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
	   <table border="0" summary="Замечание"><tr><td rowspan="2" align="center" valign="top" width="25"><a id="DockerBooleanFlags"> </a>
	   <img alt="[Замечание]" src="../common/images/admon/note.png"/></td><th align="left">Замечание</th></tr><tr><td align="left" valign="top">
	   <p>Обычно вы НЕ хотите применять <span class="term"><code>vmbr0</code></span>, так как он является адаптером по умолчанию для всего 
	   интерфейса пользователя! Вы можете поступать так! Просто попытайтесь избегать этого если у вашей ВМ отнюдь не низкая пропускная 
	   способность!</p></td></tr></table>
     </div>
   <p>Для продолжения: нажмите <span class="term"><strong class="userinput">Next</strong></span></p>
	<div class="figure"><a id="Fig0147"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0147.jpg" width="459" height="299"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>В конце вы подтвердите настройки.</p>
   <p>Для продолжения: нажмите <span class="term"><strong class="userinput">Finish</strong></span></p>
	<div class="figure"><a id="Fig0148"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0148.jpg" width="458" height="297"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>На данный момент вы должны быть способны увидеть новые настройки ВМ в дереве узлов как изображено ниже. Вы можете кликать по различным 
   закладкам в верхней части для дополнительных параметров настройки. Вы также можете изменить индивидуальные элементы в пределах этой 
   настройки кликнув на них и выбрав <span class="term"><code>edit</code></span>.</p>
	<div class="figure"><a id="Fig0149"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0149.jpg" width="504" height="226"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Так как ваш маршрутизатор pfSense имеет только один сетевой адаптер, нам понадобится добавить другой. Этот новый сетевой адаптер 
   понадобится для вашего WAN (Internet) соединения. Важно чтобы вы знали правильный аппаратный Mac адрес для этой работы. Если 
   до сих пор вы следовали указаниям, вы должны были пометить ваши адаптеры делая легким обнаружение их соответствия аппаратным Mac 
   адресам просто заглянув на обратную сторону вашей машины.</p>
   <p>Давайте продолжим: нажмите <span class="term"><strong class="userinput">Add &gt;&gt; Network Device</strong></span></p>
	<div class="figure"><a id="Fig0150"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0150.jpg" width="516" height="228"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Теперь добавим новый сетевой мост (как отображено ниже). Например, я выбрал <span class="term"><code>vmbr1</code></span>, однако это 
   может быть очень легко изменено как только пожелаете.</p>
	<div class="figure"><a id="Fig0151"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0151.jpg" width="447" height="173"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Теперь вы видите вновь добавленный адаптер в списке оборудования (как изображено ниже).</p>
     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
	   <table border="0" summary="Замечание"><tr><td rowspan="2" align="center" valign="top" width="25"><a id="DockerBooleanFlags"> </a>
	   <img alt="[Замечание]" src="../common/images/admon/note.png"/></td><th align="left">Замечание по поводу MAC адреса:</th></tr><tr><td align="left" valign="top">
	   <p>Видимый вами аппаратный адрес является псевдонимом (alias), а не настоящим адресом оборудования! Именно поэтому вы и 
	   пометили его!</p></td></tr></table>
     </div>
	<div class="figure"><a id="Fig0152"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0152.jpg" width="474" height="159"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Теперь давайте повторно проверим связь между <span class="term"><code>vmbr1</code></span> и <span class="term"><code>eth1</code></span>.
   Мы просто хотим убедиться, что <span class="term"><code>vmbr1</code></span> не указывает вместо этого на 
   <span class="term"><code>eth4</code></span>. Чтобы проверить связь, перейдите на вашу закладку сетевых средств (Network) в просмотре 
   узлов (как изображено ниже). Вы можете ясно видеть связи между всеми адаптерами. Хотя мы до сих пор не знаем настоящий Mac адрес!</p>
	<div class="figure"><a id="Fig0153"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0153.jpg" width="516" height="224"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Чтобы определить какой адаптер подключает ваш интернет потребуется некий дополнительный шаг. Я знаю что это может показаться несколько 
   сложным, однако это на самом деле не так плохо, как только вы уложите это в свою голову. Вы воспользуетесь специальной командой Linux, 
   называемой <span class="term"><strong class="userinput"><code>ifconfig</code></strong></span>.</p>
   <p>Давайте определим теперь его Mac!</p>
   <p>Откройте вашу программу <span class="term"><strong class="userinput"><code>PuTTY</code></strong></span> и зарегистрируйтесь в качестве root, 
   как вы делали это когда настраивали хранилище.</p>
   <p>Теперь наберите команду отображённую ниже с последующим нажатием клавиши <span class="emphasis"><em>Enter</em></span>.</p>
	   <pre class="screen">
# ifconfig eth1
	   </pre>
   <p>Её результат покажет действительный аппаратный Mac адрес как на приведённом ниже снимке.</p>
	<div class="figure"><a id="Fig0154"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0154.jpg" width="444" height="258"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Теперь, когда у вас есть настоящий аппаратный адрес, вы можете отобразить помеченный адаптер и подключить его к интернету.</p>
     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
	   <table border="0" summary="Замечание"><tr><td rowspan="2" align="center" valign="top" width="25"><a id="DockerBooleanFlags"> </a>
	   <img alt="[Замечание]" src="../common/images/admon/note.png"/></td><th align="left">Замечание:</th></tr><tr><td align="left" valign="top">
	   <p>Из- за такого особого требования соответствия Mac для портов WAN вы не сможете совместно использовать эти адаптеры с другими 
	   виртуальными машинами. Решение состоит в планировании того, какие серверы Proxmox будут применяться в качестве экземпляров 
	   маршрутизатора с последующим добавлением дополнительных сетевых адаптеров только в эти машины. Это небольшая плата за возможность 
	   перемещения вашего интернет- шлюза.</p></td></tr></table>
     </div>
   <p>Также можно использовать маленький 5 портовый коммутатор чтобы сделать возможной миграцию вашего шлюза маршрутизации. Просто 
   выберите другой сервер Proxmox, который вы хотите использовать в качестве холодной копии (выключенной) pfSense, повторите процедуру
   нахождения соответствия адреса на этой машине и подключите в 5 портовый коммутатор наряду с вашим действующим pfSense и вашим 
   входящим интернетом.</p>
   <p>Суммируем: ваше входящее интернет соединение подключено в 5 портовый коммутатор, а все pfSense виртуальные машины WAN также 
   подключены к этому коммутатору. Обратитесь, пожалуйста, к <a class="link" href="index.html#Case0003" target="_top">(Вариант-3) Простое 
   перемещение маршрутизатора с отключением</a> за дополнительными сведениями.</p>
   <p><span class="term"><strong class="userinput"><code>DMZ</code></strong></span> и 
   <span class="term"><strong class="userinput"><code>WAN2</code></strong></span>: Я не предлагаю устанавливать эти дополнительные адаптеры до 
   тех пор, пока не закончится первоначальная установка pfSense. Вам понадобится по крайней мере еще один виртуальный адаптер для DMZ, 
   если следовать этому полному руководству. Когда это время наступит, просто вернитесь к этому разделу и повторите процесс добавления 
   нового сетевого адаптера.</p>
   <p>Теперь ваша настройка завершена, вам нужно знать как загрузить её. Просто выберите ВМ в дереве узлов и кликните на кнопку Start в 
   верхнем правом углу. В качестве альтернативы, если установлена ОС, вы можете захотеть выбрать консоль, поэтому вы можете откликнуться 
   на приглашение. Просто кликните на опцию Start в этой консоли (как изображено ниже). Когда ваша ВМ стартует, это будет выглядеть как 
   загрузка любой другой операционной системы. Чтобы последовать процедуре установки pfSense перейдите к 
   <a class="link" href="Ch02.html" target="_top">Книга 2. pfSense</a>.</p>
	<div class="figure"><a id="Fig0155"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0155.jpg" width="515" height="320"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
  </div>
  
  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0110"> </a>1.10 Резервное копирование и восстановление ВМ</h3>
   </div></div></div>
   <p>Воспользуйтесь, пожалуйста преимуществами излагаемой далее информации, как уже упоминалось ранее в разделе
   <a class="link" href="http://onreader.mdl.ru/VirtualizationComplete/content/index.html#0003" target="_top">.3 Опыт из практики</a></p>
   <p class="title"><strong>Упрощённое восстановление после сбоев</strong></p>
   <p>Если какой- либо из ваших серверов прекращает работу, единственным самым важным элементом для восстановления <span class="term"><strong 
   class="userinput">ВСЕГДА</strong></span> будут ваши <span class="emphasis"><em>резервные копии образов ВМ</em></span>. Рассматривайте их как 
   Главные образы восстановления! Без них вы пропали, поэтому важно иметь так много копий, как это возможно!</p>
   <p>Предпочитаемая мной методика состоит в выборе NAS (виртуализированного или автономного) для использования в качестве  
   <span class="term"><strong class="userinput">первичного</strong></span> <span class="emphasis"><em>сервера резервных копий образов ВМ</em></span>.
   Этот сервер будет размещать в NFS совместно используемые Proxmox резервные копии образов. Этот совместный ресурс реплицируется вручную (один раз 
   в процессе установки) на все другие NAS сервера в вашей системе, а затем синхронизируется по расписанию с применением Rsync.</p>
   <p>Если машина выходит из строя, я могу заменить её, переустановить Proxmox, повторно установить все устройства NAS, привести в соответствие мои 
   резервные копии NFS и восстановить необходимые образы ВМ. Повторю: <span class="emphasis"><em>вы опять вернётесь к работе через 15 минут 
   или даже быстрее!</em></span> Этот метод служил мне очень хорошо и выстоял тестирование временем как скала!</p>
     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
	   <table border="0" summary="Замечание"><tr><td rowspan="2" align="center" valign="top" width="25"><a id="DockerBooleanFlags"> </a>
	   <img alt="[Замечание]" src="../common/images/admon/note.png"/></td><th align="left">Замечание:</th></tr><tr><td align="left" valign="top">
	   <p>Существует один <span class="emphasis"><em>нюанс</em></span>! Если NAS обслуживает <span class="emphasis"><em>резервные копии образов 
	   ВМ</em></span> является виртуализовыанным, например как в <a class="link" href="index.html#Case0003" target="_top">(Вариант-3) Простое 
	   перемещение маршрутизатора с отключением</a> они будут не в состоянии делать резервные копии своих собственных образов ВМ! Простейшим способом 
	   обработать их будет создать другой разделяемый сетевой ресурс резервных копий NFS на другом узле freeNAS с названием 
	   <span class="term"><code>netbackups2</code></span>. Повторю: мы применяем Rsync для автоматической синхронизации этих наборов данных между всеми 
	   узлами freeNAS. Для получения больших нюансов о системной архитектуре и потоках отсылаем вас к разделу
	   <a class="link" href="http://onreader.mdl.ru/VirtualizationComplete/content/index.html#000307" target="_top">.3.7 Схемы систем</a>.</p></td></tr></table>
     </div>
   <p><span class="term"><strong class="userinput">Храните копии на флеш- дисках</strong></span>: Другим настоятельно рекомендуемым советом является 
   копирование ваших резервных копий образов ВМ на флешки или DVD, с последующим сохранением в несгораемом сейфе. Вы легко можете сделать доступный 
   только для чтения совместный ресурс samba для ваших резервных копий образов ВМ доступный с windows машин или телефонов android. Применение метода 
   малых отпечатков, описанное в разделе <a class="link" href="http://onreader.mdl.ru/VirtualizationComplete/content/index.html#000304" target="_top">.3.4 
   Виртуализация с малыми отпечатками</a> гарантирует вам что весь архив резервных копий образов ВМ легко разместится на современной 64-128ГБ 
   флешке.</p>
   <p class="title"><strong>Как делать резервные копии ваших ВМ</strong></p>
   <p>Proxmox снабжает вас различными удобными интерфейсами резервного копирования.Просто выберите ВМ, для которой вы хотите делать резервную 
   копию, в просмотре дерева узлов и кликните закладку <span class="term"><code>Backup</code></span>. Выберите местоположение вашей резервной 
   копии на удалении с последующим нажатием на <span class="term"><strong class="userinput">Backup Now</strong></span> (как 
   изображено ниже).</p>
	<div class="figure"><a id="Fig0156"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0156.jpg" width="483" height="314"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Затем вам будет предоставлен диалог резервного копирования (изображённый ниже).</p>
   <p>Выберите ваши параметры и кликните <span class="term"><strong class="userinput">Backup</strong></span>.</p>
	<div class="figure"><a id="Fig0157"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0157.jpg" width="264" height="128"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Появится диалог продвижения, отображающий текущее состояние процесса (как отображено ниже). Это то что нужно!</p>
	<div class="figure"><a id="Fig0158"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0158.jpg" width="518" height="298"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
	   <table border="0" summary="Замечание"><tr><td rowspan="2" align="center" valign="top" width="25"><a id="DockerBooleanFlags"> </a>
	   <img alt="[Замечание]" src="../common/images/admon/note.png"/></td><th align="left">Замечание:</th></tr><tr><td align="left" valign="top">
	   <p>Резервных копий образов <span class="term"><strong class="userinput">НИКОГДА</strong></span> не достаточно. Вы всё-таки хотите выполнять 
	   обычные резервные копии изнутри гостевых машин. <span class="term"><strong class="userinput">ВАЖНО</strong></span>: я настоятельно 
	   рекомендую <span class="term"><strong class="userinput">НЕ</strong></span> пытаться делать резервные копии дисков образа ВМ, которые больше 
	   80ГБ или которые используют пробрасывание устройств (разъясняю).</p>
	   <p>Например: ВМ freeNAS, построение которой описывается в <a class="link" href="Ch03.html" target="_top">Книге 3. freeNAS</a>, с 6ТБ 
	   транзитным диском хранения должен быть настроен на применение Rsync и резервное копирование настроек из гостевых машин вашего freeNAS.</p></td></tr></table>
     </div>
   <p>Я предпочитаю рассматривать резервные копии образов Proxmox как Главные образы восстановления. <span class="emphasis"><em>Частота вашего 
   резервного копирования изнутри Proxmox должна быть очень низкой (возможно, 1 копия в несколько месяцев)</em></span>.</p>
   <p class="title"><strong>Как восстановить вашу ВМ</strong></p>
   <p>Для восстановления ВМ выберите местоположение вашей резервной копии в <span class="emphasis"><em>просмотре дерева узлов</em></span>. 
   Для данного примера я выбрал <span class="term"><strong class="userinput"><code>NFS_netbackups</code></strong></span> (изображение ниже). 
   После выбора вы должны просмотреть список архивов в закладке содержимого (Content). Теперь выберите архив, который вы хотите восстановить 
   (как отображено ниже).</p>
	<div class="figure"><a id="Fig0160"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0160.jpg" width="382" height="403"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>После выбора архива кликните на <span class="term"><strong class="userinput">Restore</strong></span> (как изображено ниже).</p>
	<div class="figure"><a id="Fig0159"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0159.jpg" width="382" height="399"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Теперь вы должны увидеть блок диалога <span class="term"><strong class="userinput">Restore VM</strong></span> (изображено ниже)
   в котором вы можете назначить новый <span class="term"><strong class="userinput">VM ID</strong></span> и выбрать местоположение 
   <span class="term"><strong class="userinput">Storage</strong></span></p>
   <p>По завершению кликните кнопку <span class="term"><strong class="userinput">Storage</strong></span> (как отображено ниже)</p>
	<div class="figure"><a id="Fig0161"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0161.jpg" width="379" height="128"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>После начала процесса вы увидите <span class="emphasis"><em>просмотрщик заданий</em></span> в котором вы сможете наблюдать 
   <span class="term"><strong class="userinput">состояние</strong></span> вашего восстановления.</p>
	<div class="figure"><a id="Fig0162"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0162.jpg" width="515" height="302"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
  </div>

  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0111"> </a>1.11 Аппаратные средства ВМ</h3>
   </div></div></div>
   <p class="title"><strong>Сетевые адаптеры</strong></p>
   <p>В некий момент вы можете добавить или изменить ваше оборудование ВМ. Proxmox предлагает широкий диапазон параметров, включающий 
   добавление, изменение и удаление как дисков, так и сетевых адаптеров. Он также делает возможным перемещение, плавное регулирование и 
   изменение размеров дисков. Вы уже добавляли сетевой адаптер ранее в этой главе для его применения в конфигурации маршрутизатора 
   pfSense, поэтому закладка аппаратных средств (Hardware) не должна быть для вас непонятной. Повторим, просто для справки в этом 
   разделе по оборудованию мы добавим сетевой адаптер, как изображено ниже.</p>
   <p>Давайте продолжим: Кликните <span class="term"><strong class="userinput">Add &gt;&gt; Network Device</strong></span>.</p>
	<div class="figure"><a id="Fig0163"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0163.jpg" width="515" height="178"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Теперь добавим новый сетевой мост (как отображено ниже). Для этого примера я выбрал <span class="term"><code>vmbr1</code></span>, 
   однако это может быть изменено в любой момент, как только вы пожелаете.</p>
	<div class="figure"><a id="Fig0164"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0164.jpg" width="498" height="168"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Теперь вы увидите в списке оборудования вновь добавленный адаптер (как изображено ниже).</p>
     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
	   <table border="0" summary="Замечание"><tr><td rowspan="2" align="center" valign="top" width="25"><a id="DockerBooleanFlags"> </a>
	   <img alt="[Замечание]" src="../common/images/admon/note.png"/></td><th align="left">Замечание по поводу MAC адреса:</th></tr><tr><td align="left" valign="top">
	   <p>Видимый вами аппаратный адрес является псевдонимом (alias), а не настоящим адресом оборудования!</p></td></tr></table>
     </div>
	<div class="figure"><a id="Fig0165"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0165.jpg" width="517" height="224"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Вы можете изменить адрес Mac, модель или мост любого выбранного адаптера просто кликнув по кнопке изменения (edit) в закладке аппаратных средств.
   Рисунки 1-3 ниже показывают диалоговые блоки изменения сетевых средств.</p>
	<div class="figure"><a id="Fig0166"> </a>
	 <p class="title"><strong>Рисунок 1</strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0166.jpg" width="498" height="173"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
	<div class="figure"><a id="Fig0167"> </a>
	 <p class="title"><strong>Рисунок 2</strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0167.jpg" width="450" height="171"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
	<div class="figure"><a id="Fig0168"> </a>
	 <p class="title"><strong>Рисунок 3</strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0168.jpg" width="449" height="167"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p class="title"><strong>Жёсткие диски</strong></p>
   <p>Добавление нового диска такое же простое. Давайте создадим новый 32ГБ диск для контроллера домена Zentyal (rfr отображено ниже). 
   Кликните <span class="term"><strong class="userinput">Add &gt;&gt; Hard Disk</strong></span></p>
	<div class="figure"><a id="Fig0169"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0169.jpg" width="514" height="229"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Вы увидите диалоговый блок <span class="term"><code>Add: Hard Disk</code></span> (изображённый ниже). Отметим, что шиной (Bus) по 
   умолчанию является <span class="term"><code>VIRTIO</code></span>. <span class="term"><code>VIRTIO</code></span> является 
   высокопроизводительным драйвером, который, однако, может быть не совместим с вашей установкой. Для большей совместимости менее беспокойной 
   шины я рекомендую <span class="term"><code>IDE</code></span>. Также отметим, что форматом по умолчанию является 
   <span class="term"><code>Qcow2</code></span>. Я ВСЕГДА применяю формат <span class="term"><code>Raw</code></span>! Это самый 
   высокопроизводительный и наиболее совместимый формат. Также ткните <span class="term"><code>Cache</code></span> 
   <span class="term"><code>Default</code></span> во избежание потери данных!</p>
	<div class="figure"><a id="Fig0170"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0170.jpg" width="444" height="245"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Рисунки 4-6 отображают различные ниспадающие диалоговые блоки жёстких дисков. Отметим: неправильно выбранные элементы будут отмечены 
   красным, пока не будет выбрано допустимое значение.</p>
	<div class="figure"><a id="Fig0171"> </a>
	 <p class="title"><strong>Рисунок 4</strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0171.jpg" width="443" height="144"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
	<div class="figure"><a id="Fig0172"> </a>
	 <p class="title"><strong>Рисунок 5</strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0172.jpg" width="444" height="197"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
	<div class="figure"><a id="Fig0173"> </a>
	 <p class="title"><strong>Рисунок 6</strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0173.jpg" width="444" height="245"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>После добавления ваш новый диск будет появляться помеченным красным до перезагрузки ВМ (как изображено ниже).</p>
	<div class="figure"><a id="Fig0174"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0174.jpg" width="292" height="151"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
  </div>

  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0112"> </a>1.12 Добавление прокидываемых ВМ</h3>
   </div></div></div>
   <p>Как уже упоминалось ранее в разделе <a class="link" href="http://onreader.mdl.ru/VirtualizationComplete/content/index.html#0003" 
   target="_top">.3 Опыт из практики</a>, я применяю совмещённые серверы. По сути вы создёте хост виртуализации Proxmox со 
   <span class="emphasis"><em>встроенным сервером NAS</em></span>. Вы устанавливаете NAS просто как другую ВМ с его ОС расположенной на 
   виртуальном диске. Однако действительные диски хранения будут расположены на физических хранилищах LVM назначаемых техникой, 
   именуемой транзитом/ пробрасыванием оборудования (<span class="term"><strong class="userinput">hardware pass-through</strong></span>).</p>
   <p>Этот метод делает возможными <span class="emphasis"><em>очень маленькие отпечатки резервных копий</em></span>, так как вы делаете 
   резервные копии только операционной системы NAS, а <span class="term"><strong class="userinput">НЕ</strong></span> самих данных. 
   Он также предоставляет в среднем лучшую пропускную способность для циклов чтения/ записи данных. Я проводил тестирование продолжительных 
   скоростей пропускной способности в диапазоне 30-60 МегаБайт/ сек с применением гигабитных адаптеров. Объединение ваших адаптеров на самом 
   деле даёт лучшую производительность, но я люблю оставлять всё простым!</p>
   <p>Наибольшее преимущество состоит в том, что ваши данные <span class="term"><strong class="userinput">НЕ</strong></span> сохраняются 
   в файле виртуального диска! Даже если вы разрушите свою ВМ, данные останутся в безопасности!</p>
   <p>Теперь когда вы всё поняли, давайте добавим 6ТБ том с чередованием в новую установку freeNAS. Как вы можете видеть, ваша установка 
   freeNAS имеет только один 8ГБ диск, на котором расположена ОС (как изображено ниже).</p>
	<div class="figure"><a id="Fig0175"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0175.jpg" width="482" height="199"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Давайте откроем <span class="term"><strong class="userinput"><code>PuTTY</code></strong></span> и зарегистрируемся под 
   <span class="term"><code>root</code></span> на вашем сервере Proxmox. Затем нам нужно найти наши диски с помощью следующей команды 
   (как изображено ниже).</p>
	   <pre class="screen">
# cat /proc/partitions
	   </pre>
	<div class="figure"><a id="Fig0176"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0176.jpg" width="494" height="309"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Как вы можете увидеть, самыми большими дисками (как изображено выше) являются <span class="term"><code>/dev/sdb</code></span> и 
   <span class="term"><code>/dev/sdс</code></span>.</p>
   <p>Также отметим, что ещё есть <span class="term"><code>/dev/sdb1</code></span> и <span class="term"><code>/dev/sdс1</code></span>. 
   Это отображает то, что на каждом диске <span class="emphasis"><em>присутствует один раздел</em></span>. Размеры раздела информируют, что 
   будет использовано не всё доступное пространство. Мы должны изменить это! Для изменения <span class="term"><code>/dev/sdb</code></span> 
   наберите следующую команду:</p>
	   <pre class="screen">
# fdisk /dev/sdb
	   </pre>
   <p>Теперь вы увидите что-то навроде (изображено ниже):</p>
	<div class="figure"><a id="Fig0177"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0177.jpg" width="494" height="308"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Теперь нажмите <span class="term"><strong class="userinput">m &gt;&gt; Enter</strong></span></p>
   <p>Вы увидите экран подсказки (отображённый ниже). Нам нужно создание <span class="emphasis"><em>empty DOS partition table</em></span> 
   (пустой таблицы разделов DOS).</p>
	<div class="figure"><a id="Fig0178"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0178.jpg" width="494" height="310"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>   <p></p>
   <p>Теперь нажмите <span class="term"><strong class="userinput">o &gt;&gt; Enter</strong></span></p>
   <p>С последующим <span class="term"><strong class="userinput">w &gt;&gt; Enter</strong></span></p>
   <p>Данная последовательность команд создаст новую <span class="emphasis"><em>пустую таблицу разделов DOS</em></span> и запишет 
   изменения на диск.</p>
   <p>Далее нам нужно повторить эти шаги для <span class="term"><code>/dev/sdс</code></span>. НЕ беспокойтесь о недостатке разделов! 
   Прелесть этого метода в том, что <span class="term"><strong class="userinput">LVM</strong></span> наплевать!</p>
   <p>Давайте проверим наши диски снова чтобы убедиться, что разделы утрачены с применением следующей команды:</p>
	   <pre class="screen">
# cat /proc/partitions
	   </pre>
	<div class="figure"><a id="Fig0179"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0179.jpg" width="493" height="273"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Как вы теперь видите (выше) <span class="term"><code>/dev/sdb</code></span> и <span class="term"><code>/dev/sdс</code></span> 
   теперь могут использовать <span class="emphasis"><em>полную ёмкость</em></span>.</p>
   <p>Теперь мы создадим <span class="emphasis"><em>физические тома</em></span> (PV) LVM с помощью следующих команд:</p>
	   <pre class="screen">
# pvcreate /dev/sdb
# pvcreate /dev/sdc
	   </pre>
   <p>или</p>
	   <pre class="screen">
# pvcreate /dev/sd[b,c]
	   </pre>
	<p><span class="emphasis"><em>{Прим. пер.: Если операция создания тома завершилась неудачно, проверьте ещё раз: создаётся ли 
	на самом деле таблица разделов DOS при выходе из fdisk с записью (<span class="term"><strong class="userinput">w &gt;&gt; 
	Enter</strong></span>). Если в действительности таблица не создаётся, это, например, может означать что на диске уже 
	существует некая таблица разделов. Проверьте, что работаете именно с нужным диском, и когда полностью будете уверены в том, 
	что делаете, выполните следующие команды:</em></span></p>
	   <pre class="screen">
# dd if=/dev/zero of=/dev/&lt;diskname&gt; bs=1k count=1
# blockdev --rereadpt /dev/&lt;diskname&gt;
	   </pre>
	<p><span class="emphasis"><em>Эти команды уничтожат таблицу разделов на целевом диске.}</em></span></p>
	<div class="figure"><a id="Fig0180"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0180.jpg" width="494" height="309"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Приведённый выше вывод отображает успешное создание.</p>
   <p>Далее мы создадим <span class="emphasis"><em>группу томов</em></span> (VG), содержащую оба диска следующей командой:</p>
	   <pre class="screen">
# vgcreate freenas4 /dev/sd[b,c]
	   </pre>
	<div class="figure"><a id="Fig0181"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0181.jpg" width="450" height="310"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Приведённый выше вывод отображает успешное создание VG.</p>
   <p>В качестве окончательного шага мы создадим <span class="emphasis"><em>логический том</em></span> (LV) с чередованием используя всё 
   доступное пространство. <span class="term"><strong class="userinput">Чередование LVM</strong></span> 
   эквивалентно <span class="term"><strong class="userinput">RAID-0</strong></span> для <span class="emphasis"><em>макисмальной</em></span>
   пропускной способности диска.</p>
   <p>Наберите следующую команду для создания чередования:</p>
	   <pre class="screen">
# lvcreate -l 100%FREE -i2 -n 6tbstore freenas4
	   </pre>
   <p>Здесь: <span class="term"><code>-i2</code></span> число чередований, <span class="term"><code>n</code></span> имя.</p>
	<div class="figure"><a id="Fig0182"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0182.jpg" width="494" height="310"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Приведённый выше вывод отображает успешное создание LV.</p>
   <p>Как я уже упоминал выше, <span class="term"><strong class="userinput">LVM</strong></span> Linux <span class="emphasis"><em>очень</em></span>
   мощен и гибок. Ниже приводятся 3 самые полезные команды <span class="term"><strong class="userinput">LVM</strong></span>:</p>
	   <pre class="screen">
# pvscan
	   </pre>
   <p>Эта команда выводит список <span class="term"><strong class="userinput">ВСЕХ</strong></span> известных физических томов (как 
   изображено ниже).</p>
	<div class="figure"><a id="Fig0183"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0183.jpg" width="493" height="310"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
	   <pre class="screen">
# vgscan
	   </pre>
   <p>Эта команда выводит список <span class="term"><strong class="userinput">ВСЕХ</strong></span> известных групп томов (как 
   изображено ниже).</p>
	<div class="figure"><a id="Fig0184"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0184.jpg" width="493" height="308"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
	   <pre class="screen">
# lvscan
	   </pre>
   <p>Эта команда выводит список <span class="term"><strong class="userinput">ВСЕХ</strong></span> известных логических томов (как 
   изображено ниже).</p>
	<div class="figure"><a id="Fig0185"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0185.jpg" width="493" height="309"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Выше вы можете видеть вновь созданный том 6ТБ с чередованием. Теперь мы готовы назначить этот том ВМ 
   <span class="term"><code>freeNAS-4</code></span>. Вы отметите, что идентификационный номер <span class="term"><code>freeNAS-4</code></span> 
   <span class="term"><code>800</code></span>, а <span class="term"><code>IDE1</code></span> и <span class="term"><code>IDE3</code></span> 
   доступны (как изображено ниже).</p>
	<div class="figure"><a id="Fig0186"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0186.jpg" width="479" height="194"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Чтобы назначить новый диск мы выполним специальную команду <span class="term"><strong class="userinput"><code>QEMU</code></strong></span>
   следующим образом:</p>
	   <pre class="screen">
# qm set 800 -ide1 /dev/freenas4/6tbstore
	   </pre>
   <p>Введённая в <span class="term"><strong class="userinput"><code>PuTTY</code></strong></span> команды выглядит примерно так (как 
   изображено ниже).</p>
	<div class="figure"><a id="Fig0187"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0187.jpg" width="493" height="308"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>Результат этой команды очевиден по новому диску <span class="term"><code>IDE1</code></span>, отображаемому в окне оборудования 
   <span class="term"><code>freeNAS-4</code></span>.</p>
     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
	   <table border="0" summary="Замечание"><tr><td rowspan="2" align="center" valign="top" width="25"><a id="DockerBooleanFlags"> </a>
	   <img alt="[Замечание]" src="../common/images/admon/note.png"/></td><th align="left">Замечание:</th></tr><tr><td align="left" valign="top">
	   <p>Вам придется обновить страницу закладки чтобы появился новый диск.</p></td></tr></table>
     </div>
	<div class="figure"><a id="Fig0188"> </a>
	 <p class="title"><strong></strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="figures/Fig0188.jpg" width="485" height="198"/><br />
	 <span></span>
	 </div></div>
	</div><br class="figure-break"/>
   <p>ВМ <span class="term"><code>freeNAS-4</code></span> (выше) теперь может быть загружена, а новый 6ТБ диск настроен как 
   <a class="link" href="http://onreader.mdl.ru/FreeBSDMasteryZFS/content/index.html" target="_top">ZFS</a> с чередованием.</p>
	 <div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">
      <table border="0" summary="Предостережение"><tr><td rowspan="2" align="center" valign="top" width="25">
      <img alt="[Предостережение]" src="../common/images/admon/warning.png"/></td><th align="left">Запомните, пожалуйста:</th></tr><tr><td align="left" valign="top">
      <p>Важно заметить, что <span class="term"><code>freeNAS-4</code></span> привязан к серверу 
	   <span class="term"><code>Proxmox3</code></span> своим аппаратным транзитным диском. Он не может быть перемещён на другую 
	   физическую машину пока не будет удалены физические диски. Прочие ВМ (изображённые выше) могут легко перемещаться на другие 
	   физические машины простым резервным копированием/ восстановлением. Они никак НЕ привязаны к серверу 
	   <span class="term"><code>Proxmox3</code></span>.</p></td></tr></table>
     </div>
  </div>

  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0113"> </a>1.13 Сложности Proxmox</h3>
   </div></div></div>
   <p>Поиск неисправностей Proxmox прост! Их просто нет! Может случиться, что у вас будет заблокированная ВМ. Просто воспользуйтесь 
   следующей командой: <span class="term"><code># qm unlock [vm-ID]</code></span>. Например:</p>
	   <pre class="screen">
# qm unlock 800
	   </pre>
   <p>здесь <span class="term"><code>800</code></span> это номер <span class="term"><code>[vm-ID]</code></span> (как изображено выше) 
   в просмотре дерева узлов.</p>
   <p>Вы также можете столкнуться с тем, что новая настройка откажется загружаться. Обычно помогает изменение типа  ЦПУ с 
   <span class="term"><code>KVM</code></span> на <span class="term"><code>QEMU</code></span> или с <span class="term"><code>QEMU</code></span>
   на <span class="term"><code>KVM</code></span>.</p>
   <p>Наконец: некоторые операционные системы могут требовать размер и формат диска ВМ перед своей загрузкой.</p>
  </div>

  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0114"> </a>1.14 Обновление Proxmox</h3>
   </div></div></div>
   <p>Когда приходит время обновлять и совершенствовать Proxmox, я нахожу лучше всего работающим метод 
   <span class="term"><strong class="userinput">KISS</strong></span> (keep it simple stupid, Делай проще, тупица!) 
   <span class="term"><strong class="userinput">НЕ</strong></span> пытайтесь при 
   <span class="term"><strong class="userinput">ЛЮБЫХ</strong></span> обстоятельствах обновлять или улучшать прекрасно работающую установку! 
   Linux не любит Windows! Когда дела идут плохо, они стремятся идти 
   <span class="term"><strong class="userinput">НАИХУДШИМ</strong></span> образом!</p>
   <p>Существуют различные способы обновления с применением команд <span class="term"><code>apt</code></span> и 
   <span class="term"><code>aptitude</code></span>, но я НЕ рекомендую их и целая глава уйдет на объяснение этого.
   <span class="emphasis"><em>Вы потратите меньше времени, если вы просто сделаете резервные копии своих ВМ, восстановите их на 
   другие узлы, а затем повторно установите самый последний дистрибутив на узел Proxmox о котором идёт речь.</em></span></p>
   <p>С применением DVD установка и настройка займут 10-15 минут! При обновлении через командную строку это займёт 45-60 минут, 
   <span class="term"><strong class="userinput"><em class="emphasis">ЕСЛИ</em></strong></span> всё пойдёт хорошо. Причём это
   <span class="term"><strong class="userinput"><em class="emphasis">БОЛЬШОЕ ЕСЛИ</em></strong></span>! Когды вы единственный 
   ИТ администратор в качестве приходящей няни для 200 машин/ пользователей вы пытаетесь обходить сценарии 
   <span class="term"><strong class="userinput"><em class="emphasis">ЕСЛИ</em></strong></span> и 
   <span class="term"><strong class="userinput">каждый раз</strong></span> следовать путём 
   <span class="term"><strong class="userinput">выстрела без промаха</strong></span>!</p>
  </div>

 </div>

<!----><script type="text/javascript" src="FooterAndSidebar.js">
</script><script type="text/javascript"><!--</div id="content"> is inside next code
document.write(FooterAndSidebar);//-->
</script>

</body></html>